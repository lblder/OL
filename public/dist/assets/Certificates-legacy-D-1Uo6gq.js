System.register(["./index-legacy-VniDFTuT.js","./useTitle-legacy-CH79vzdE.js","./certificate-legacy-CuUFzHcx.js"],function(e,t){"use strict";var r,n,c,i,a,l,u,d,s,g,o,h,f,p,b,y,$,w,_,m,v,C,j,k,x,S,q,L,D,R,U,W,z,N,A,I,J,O,X,E,F,G,T,V,Z,B,H,K,M,P;return{setters:[e=>{r=e.K,n=e.aZ,c=e.J,i=e.g,a=e.o,l=e.W,u=e.ac,d=e.V,s=e.y,g=e.aM,o=e.d0,h=e.cP,f=e.cQ,p=e.a2,b=e.cR,y=e.cS,$=e.X,w=e.ck,_=e.cU,m=e.cV,v=e.cW,C=e.cX,j=e.cY,k=e.F,x=e.cZ,S=e.aN,q=e.aG,L=e.aH,D=e.aI,R=e.bm,U=e.aJ,W=e.bJ,z=e.bw,N=e.bx,A=e.bz,I=e.bB,J=e.bD,O=e.bE,X=e.bF,E=e.bG,F=e.d1,G=e.bg,T=e.aL,V=e.bh,Z=e.bl},e=>{B=e.b},e=>{H=e.h,K=e.i,M=e.j,P=e.k}],execute:function(){e("default",()=>{const e=s();B("certificate.title");const[t,Q]=r(null),[Y,ee]=r([]),[te,re]=n(H),[,ne]=n(K),[ce,ie]=r("user"),[ae,le]=r(""),[ue,de]=r({}),[se,ge]=r(!1),[,oe]=n(M);c(()=>{re().then(e=>{Z(e,e=>Q(e))}),ne().then(e=>{Z(e,e=>ee(e||[]))})});const he=i(()=>Y().some(e=>"pending"===e.status)),fe=async()=>{if(!(()=>{const t={};return ce()||(t.type=e("certificate.type_required")),ae()||(t.reason=e("certificate.reason_required")),de(t),0===Object.keys(t).length})())return;const t=await oe({type:ce(),reason:ae()});Z(t,()=>{V.success(e("certificate.request_created")),ge(!1),ie("user"),le(""),de({}),ne().then(e=>{Z(e,e=>ee(e||[]))})})},pe=async()=>{try{const r=await P(),n=URL.createObjectURL(r),c=document.createElement("a");c.href=n,c.download=`${t()?.name||"certificate"}.crt`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(n),V.success(e("certificate.download_started"))}catch(r){V.error(`${e("certificate.download_started")} - ${r.message}`)}};return a($,{w:"$full",alignItems:"start",spacing:"$4",get children(){return[a(u,{justifyContent:"space-between",w:"$full",get children(){return[a(d,{fontSize:"$2xl",fontWeight:"$bold",get children(){return e("certificate.title")}}),a(g,{colorScheme:"primary",onClick:()=>ge(!0),get children(){return e("certificate.request_certificate")}})]}}),l(()=>l(()=>!!te())()?a(u,{spacing:"$2",get children(){return[a(o,{size:"sm"}),a(d,{get children(){return e("global.loading")}})]}}):[l(()=>l(()=>!t())()?a(h,{status:"info",get children(){return[a(f,{}),a(p,{flex:"1",get children(){return[a(b,{get children(){return e("certificate.no_certificates")}}),a(y,{display:"block",get children(){return e("certificate.no_certificates_desc")}})]}})]}}):a($,{w:"$full",spacing:"$4",p:"$4",border:"1px solid $neutral7",rounded:"$md",get children(){return[a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{fontWeight:"$semibold",get children(){return t().name}}),a(w,{get colorScheme(){return l(()=>"valid"===t().status)()?"success":"expiring"===t().status?"warning":"neutral"},get children(){return e(`certificate.${t().status}`)}})]}}),a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{get children(){return[l(()=>e("certificate.type")),": ",l(()=>e(`certificate.${t().type}`))]}}),a(d,{get children(){return[l(()=>e("certificate.owner")),": ",l(()=>t().owner)]}})]}}),a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{get children(){return[l(()=>e("certificate.issued_date")),": ",l(()=>l(()=>!!t().issued_date)()?new Date(t().issued_date).toLocaleDateString():"N/A")]}}),a(d,{get children(){return[l(()=>e("certificate.expiration_date")),": ",l(()=>l(()=>!!t().expiration_date)()?new Date(t().expiration_date).toLocaleDateString():"N/A")]}})]}}),a(g,{onClick:pe,get children(){return e("certificate.download")}})]}})),l(()=>l(()=>!!he())()?a($,{w:"$full",spacing:"$4",get children(){return[a(d,{fontSize:"$lg",fontWeight:"$semibold",get children(){return e("certificate.certificate_requests")}}),a(p,{w:"$full",overflowX:"auto",get children(){return a(_,{dense:!0,get children(){return[a(m,{get children(){return a(v,{get children(){return[a(C,{get children(){return e("certificate.type")}}),a(C,{get children(){return e("certificate.reason")}}),a(C,{get children(){return e("certificate.status")}}),a(C,{get children(){return e("certificate.created_at")}})]}})}}),a(j,{get children(){return a(k,{get each(){return Y()},children:t=>a(v,{get children(){return[a(x,{get children(){return e(`certificate.${t.type}`)}}),a(x,{get children(){return t.reason}}),a(x,{get children(){return a(w,{get colorScheme(){return"pending"===t.status?"warning":"valid"===t.status?"success":"danger"},get children(){return e(`certificate.${t.status}`)}})}}),a(x,{get children(){return l(()=>!!t.created_at)()?new Date(t.created_at).toLocaleDateString():"N/A"}})]}})})}})]}})}})]}}):a(h,{status:"info",get children(){return[a(f,{}),a(p,{flex:"1",get children(){return[a(b,{get children(){return e("certificate.no_requests")}}),a(y,{display:"block",get children(){return e("certificate.no_requests_desc")}})]}})]}}))]),a(S,{get opened(){return se()},onClose:()=>ge(!1),get children(){return[a(q,{}),a(L,{get children(){return[a(D,{get children(){return e("certificate.request_certificate")}}),a(R,{}),a(U,{get children(){return a($,{spacing:"$4",get children(){return[a(W,{get invalid(){return!!ue().type},get children(){return[a(z,{get children(){return e("certificate.type")}}),a(N,{get value(){return ce()},onChange:e=>ie(e),get children(){return[a(A,{get children(){return a(I,{})}}),a(J,{get children(){return a(O,{get children(){return[a(X,{value:"user",get children(){return a(E,{get children(){return e("certificate.user")}})}}),a(X,{value:"node",get children(){return a(E,{get children(){return e("certificate.node")}})}})]}})}})]}}),a(F,{get children(){return ue().type}})]}}),a(W,{get invalid(){return!!ue().reason},get children(){return[a(z,{get children(){return e("certificate.reason")}}),a(G,{get value(){return ae()},onInput:e=>le(e.currentTarget.value),get placeholder(){return e("certificate.reason_placeholder")}}),a(F,{get children(){return ue().reason}})]}})]}})}}),a(T,{get children(){return a(u,{spacing:"$2",get children(){return[a(g,{onClick:()=>ge(!1),get children(){return e("global.cancel")}}),a(g,{colorScheme:"primary",onClick:fe,get children(){return e("global.submit")}})]}})}})]}})]}})]}})})}}});

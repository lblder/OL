System.register(["./index-legacy-BmFN10UP.js","./useTitle-legacy-qyCEHHxL.js","./certificate-legacy-ZLt9tKhk.js"],function(e,t){"use strict";var r,n,c,i,a,l,u,d,s,g,o,h,f,p,b,$,y,w,_,m,v,C,j,k,x,S,q,L,D,R,O,U,I,z,A,N,W,E,K,M,T,B,F,G,H,J,P,Q,X,V;return{setters:[e=>{r=e.B,n=e.b9,c=e.C,i=e.O,a=e.D,l=e.ae,u=e.au,d=e.ad,s=e.o,g=e.K,o=e.dj,h=e.d6,f=e.d7,p=e.al,b=e.d8,$=e.d9,y=e.af,w=e.cs,_=e.db,m=e.dc,v=e.dd,C=e.de,j=e.df,k=e.R,x=e.dg,S=e.L,q=e.M,L=e.E,D=e.F,R=e.bx,O=e.G,U=e.bU,I=e.bH,z=e.bI,A=e.bK,N=e.bM,W=e.bO,E=e.bP,K=e.bQ,M=e.bR,T=e.dk,B=e.I,F=e.J,G=e.r,H=e.bw},e=>{J=e.b},e=>{P=e.h,Q=e.i,X=e.j,V=e.k}],execute:function(){e("default",()=>{const e=s();J("certificate.title");const[t,Y]=r(null),[Z,ee]=r([]),[te,re]=n(P),[,ne]=n(Q),[ce,ie]=r("user"),[ae,le]=r(""),[ue,de]=r({}),[se,ge]=r(!1),[,oe]=n(X);c(()=>{re().then(e=>{H(e,e=>Y(e))}),ne().then(e=>{H(e,e=>ee(e||[]))})});const he=i(()=>Z().some(e=>"pending"===e.status)),fe=async()=>{if(!(()=>{const t={};return ce()||(t.type=e("certificate.type_required")),ae()||(t.reason=e("certificate.reason_required")),de(t),0===Object.keys(t).length})())return;const t=await oe({type:ce(),reason:ae()});H(t,()=>{G.success(e("certificate.request_created")),ge(!1),ie("user"),le(""),de({}),ne().then(e=>{H(e,e=>ee(e||[]))})})},pe=async()=>{try{const r=await V(),n=URL.createObjectURL(r),c=document.createElement("a");c.href=n,c.download=`${t()?.name||"certificate"}.crt`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(n),G.success(e("certificate.download_started"))}catch(r){G.error(`${e("certificate.download_started")} - ${r.message}`)}};return a(y,{w:"$full",alignItems:"start",spacing:"$4",get children(){return[a(u,{justifyContent:"space-between",w:"$full",get children(){return[a(d,{fontSize:"$2xl",fontWeight:"$bold",get children(){return e("certificate.title")}}),a(g,{colorScheme:"primary",onClick:()=>ge(!0),get children(){return e("certificate.request_certificate")}})]}}),l(()=>l(()=>!!te())()?a(u,{spacing:"$2",get children(){return[a(o,{size:"sm"}),a(d,{get children(){return e("global.loading")}})]}}):[l(()=>l(()=>!t())()?a(h,{status:"info",get children(){return[a(f,{}),a(p,{flex:"1",get children(){return[a(b,{get children(){return e("certificate.no_certificates")}}),a($,{display:"block",get children(){return e("certificate.no_certificates_desc")}})]}})]}}):a(y,{w:"$full",spacing:"$4",p:"$4",border:"1px solid $neutral7",rounded:"$md",get children(){return[a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{fontWeight:"$semibold",get children(){return t().name}}),a(w,{get colorScheme(){return l(()=>"valid"===t().status)()?"success":"expiring"===t().status?"warning":"neutral"},get children(){return e(`certificate.${t().status}`)}})]}}),a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{get children(){return[l(()=>e("certificate.type")),": ",l(()=>e(`certificate.${t().type}`))]}}),a(d,{get children(){return[l(()=>e("certificate.owner")),": ",l(()=>t().owner)]}})]}}),a(u,{w:"$full",justifyContent:"space-between",get children(){return[a(d,{get children(){return[l(()=>e("certificate.issued_date")),": ",l(()=>l(()=>!!t().issued_date)()?new Date(t().issued_date).toLocaleDateString():"N/A")]}}),a(d,{get children(){return[l(()=>e("certificate.expiration_date")),": ",l(()=>l(()=>!!t().expiration_date)()?new Date(t().expiration_date).toLocaleDateString():"N/A")]}})]}}),a(g,{onClick:pe,get children(){return e("certificate.download")}})]}})),l(()=>l(()=>!!he())()?a(y,{w:"$full",spacing:"$4",get children(){return[a(d,{fontSize:"$lg",fontWeight:"$semibold",get children(){return e("certificate.certificate_requests")}}),a(p,{w:"$full",overflowX:"auto",get children(){return a(_,{dense:!0,get children(){return[a(m,{get children(){return a(v,{get children(){return[a(C,{get children(){return e("certificate.type")}}),a(C,{get children(){return e("certificate.reason")}}),a(C,{get children(){return e("certificate.status")}}),a(C,{get children(){return e("certificate.created_at")}})]}})}}),a(j,{get children(){return a(k,{get each(){return Z()},children:t=>a(v,{get children(){return[a(x,{get children(){return e(`certificate.${t.type}`)}}),a(x,{get children(){return t.reason}}),a(x,{get children(){return a(w,{get colorScheme(){return"pending"===t.status?"warning":"valid"===t.status?"success":"danger"},get children(){return e(`certificate.${t.status}`)}})}}),a(x,{get children(){return l(()=>!!t.created_at)()?new Date(t.created_at).toLocaleDateString():"N/A"}})]}})})}})]}})}})]}}):a(h,{status:"info",get children(){return[a(f,{}),a(p,{flex:"1",get children(){return[a(b,{get children(){return e("certificate.no_requests")}}),a($,{display:"block",get children(){return e("certificate.no_requests_desc")}})]}})]}}))]),a(S,{get opened(){return se()},onClose:()=>ge(!1),get children(){return[a(q,{}),a(L,{get children(){return[a(D,{get children(){return e("certificate.request_certificate")}}),a(R,{}),a(O,{get children(){return a(y,{spacing:"$4",get children(){return[a(U,{get invalid(){return!!ue().type},get children(){return[a(I,{get children(){return e("certificate.type")}}),a(z,{get value(){return ce()},onChange:e=>ie(e),get children(){return[a(A,{get children(){return a(N,{})}}),a(W,{get children(){return a(E,{get children(){return[a(K,{value:"user",get children(){return a(M,{get children(){return e("certificate.user")}})}}),a(K,{value:"node",get children(){return a(M,{get children(){return e("certificate.node")}})}})]}})}})]}}),a(T,{get children(){return ue().type}})]}}),a(U,{get invalid(){return!!ue().reason},get children(){return[a(I,{get children(){return e("certificate.reason")}}),a(B,{get value(){return ae()},onInput:e=>le(e.currentTarget.value),get placeholder(){return e("certificate.reason_placeholder")}}),a(T,{get children(){return ue().reason}})]}})]}})}}),a(F,{get children(){return a(u,{spacing:"$2",get children(){return[a(g,{onClick:()=>ge(!1),get children(){return e("global.cancel")}}),a(g,{colorScheme:"primary",onClick:fe,get children(){return e("global.submit")}})]}})}})]}})]}})]}})})}}});

System.register(["./APlayer.min-legacy-DAInMID6.js","./index-legacy-VniDFTuT.js","./useTitle-legacy-CH79vzdE.js","./icon-legacy-DffONu1z.js","./index-legacy-B-ZTtTkV.js","./index-legacy-CqHab1CM.js"],function(a,e){"use strict";var r,o,l,t,n,s,i,c,p,d,u,y,m,h,v;return{setters:[a=>{r=a.A},a=>{o=a.a0,l=a.u,t=a.P,n=a.a9,s=a.ab,i=a.o,c=a.a2,p=a.am,d=a.a5,u=a.dW,y=a.dX,m=a.x},a=>{h=a.a},a=>{v=a.O},null,null],execute:function(){var e=document.createElement("style");e.textContent="#audio-player{border-radius:8px}.aplayer{background:var(--hope-colors-neutral2);color:var(--hope-colors-neutral12)!important}.aplayer-body .aplayer-pic{background-color:unset!important}.aplayer .aplayer-info .aplayer-music .aplayer-author{color:var(--hope-colors-neutral11)}.aplayer .aplayer-list ol li:hover,.aplayer .aplayer-list ol li.aplayer-list-light{background:var(--hope-colors-neutral4)}.aplayer .aplayer-list ol li .aplayer-list-author{color:var(--hope-colors-neutral9)}.aplayer .aplayer-list ol li .aplayer-list-index{color:var(--hope-colors-neutral10)}.aplayer .aplayer-lrc:after{background:none}.aplayer .aplayer-lrc:before{background:none}.aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-icon path{fill:var(--hope-colors-neutral12)}.aplayer .aplayer-lrc p{color:var(--hope-colors-neutral12)}.aplayer .aplayer-list ol li{border-top:1px solid var(--hope-colors-neutral6)}.aplayer.aplayer-withlist .aplayer-info{border-bottom:1px solid var(--hope-colors-neutral7)}\n/*$vite$:1*/",document.head.appendChild(e),a("default",()=>{const{proxyLink:a,rawLink:e,previewPage:g}=o(),{searchParams:w}=l();let f,k=t.objs.filter(a=>a.type===v.AUDIO);0!==k.length&&"search"!==w.from||(k=[t.obj]);const b=r=>{let o;const l=t.objs.find(a=>y(a.name)===y(r.name)&&a.name.endsWith(".lrc"));let n;l&&(o=a(l,!0));const s=t.objs.find(a=>a.type===v.IMAGE&&(y(a.name).toLowerCase()===y(r.name).toLowerCase()||"front"===y(a.name).toLowerCase()||"cover"===y(a.name).toLowerCase()||"folder"===y(a.name).toLowerCase()));n=s?e(s,!0):r.thumb||m("audio_cover")||"https://res.oplist.org/logo/logo.svg";const i={name:r.name,artist:"Unknown",url:e(r,!0),cover:n,lrc:o};if("NeteaseMusic"===t.provider){const a=r.name.match(/((.+)\s-\s)?(.+)\.(mp3|flac)/);i.artist=a?.[2]||"Unknown",i.name=a?.[3]||r.name;const e=new URL(g(r).replace(/\.(mp3|flac)/,".lrc"));i.lrc=decodeURIComponent(e.pathname)}return i};return n(()=>{f=new r({container:document.querySelector("#audio-player"),mini:!1,autoplay:d("audio_autoplay"),theme:p(),loop:"all",order:"list",preload:"auto",volume:.7,mutex:!0,listFolded:!1,lrcType:"NeteaseMusic"===t.provider?1:3,audio:k.map(b)});const a=f.lrc.switch,e=f.lrc.update;f.lrc.switch=r=>{f.lrc.update=()=>{},a.call(f.lrc,r),f.lrc.update=e},"NeteaseMusic"===t.provider&&f.on("loadstart",()=>{const a=f.list.index;if(!f.list.audios[a].lrc)return;const e=f.list.audios[a].lrc;u(e).then(e=>{f.lrc.async=!0,f.lrc.parsed[a]=void 0,f.list.audios[a].lrc=e.data.raw_url,f.lrc.switch(a),f.list.audios[a].lrc="",f.lrc.async=!1})});const o=k.findIndex(a=>a.name===t.obj.name);-1!==o&&f.list.switch(o),"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("seekto",a=>f.seek(a.seekTime)),f.list.audios.length>1&&(navigator.mediaSession.setActionHandler("previoustrack",()=>{f.skipBack()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{f.skipForward()})),f.on("play",()=>{const a=f.list.audios[f.list.index];h(a.name),navigator.mediaSession.metadata=new MediaMetadata({title:a.name,artist:"Unknown"===a.artist?void 0:a.artist,artwork:[{src:a.cover}]})}))}),s(()=>{f?.destroy()}),i(c,{w:"$full",id:"audio-player"})})}}});

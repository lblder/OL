System.register(["./index-legacy-VniDFTuT.js","./share-legacy-HzLthkxb.js","./ResponsiveGrid-legacy-BEd-6pWF.js","./index-legacy-BbIbJMhB.js"],function(e,r){"use strict";var t,n,a,l,o,u,g,i,d,c,h,s,p,m,v,y,f,b,C,w,x,$,_,S,k,O,I,T,F,H,N,z,M,P,j,R,B,q,D,E,J,L,G,V,X,Z,K,W,A,Q,U,Y,ee,re,te,ne,ae,le,oe,ue,ge,ie,de;return{setters:[e=>{t=e.K,n=e.o,a=e.d6,l=e.a2,o=e.bM,u=e.d7,g=e.aZ,i=e.cI,d=e._,c=e.d8,h=e.J,s=e.Z,p=e.ac,m=e.S,v=e.au,y=e.am,f=e.d0,b=e.V,C=e.ci,w=e.W,x=e.D,$=e.X,_=e.F,S=e.b5,k=e.bl,O=e.aF,I=e.bO,T=e.y,F=e.ai,H=e.aN,N=e.aG,z=e.aH,M=e.bm,P=e.aI,j=e.aJ,R=e.aL,B=e.aM,q=e.bw,D=e.M,E=e.N,J=e.bg,L=e.bI,G=e.bx,V=e.bP,X=e.az,Z=e.bJ,K=e.u,W=e.bi,A=e.bN,Q=e.bV,U=e.bh,Y=e.a3,ee=e.bL},e=>{re=e.r,te=e.g},e=>{ne=e.T,ae=e.R},e=>{le=e.l,oe=e.w,ue=e.x,ge=e.y,ie=e.z,de=e.k}],execute:function(){const r=a(),ce=e=>{const[a,o]=t("/");return e.handle?.({setPath:o}),n(l,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:a,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0}},get children(){return n(he,{path:"/"})}})}})},he=e=>{const{isHidePath:a}=o(),[O,I]=t(),{value:T,onChange:F,forceRoot:H,autoOpen:N,showEmptyIcon:z,showHiddenFolder:M}=u(r),[P,j]=g(()=>i(e.path,d(),1,0,!1));let R=!1;const B=async()=>{if(O()?.length)return;const e=await j();k(e,e=>{R=!0,I(e.content||[])},()=>{q()&&D()})},{isOpen:q,onToggle:D}=function(){const[e,r]=t(!1);return{isOpen:e,onToggle:()=>r(!e()),onOpen:()=>r(!0),onClose:()=>r(!1)}}(),E=()=>T()===e.path,J=c(e.path);return h(s(T,async e=>{N&&J(e)&&(q()||D(),R||B())})),n(m,{get when(){return M||!(a(e.path)&&!J(T()))},get children(){return n(l,{get children(){return[n(p,{spacing:"$2",get children(){return[n(m,{get when(){return!P()},get fallback(){return n(f,{size:"sm",get color(){return y()}})},get children(){return n(m,{get when(){return!Boolean(z&&void 0!==O()&&!O()?.length)},get fallback(){return n(v,{get color(){return y()},as:oe})},get children(){return n(v,{get color(){return y()},as:le,get transform(){return q()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{D(),q()&&B()}})}})}}),n(v,{get color(){return y()},as:ue,cursor:"pointer"}),n(b,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return E()?"$info8":"transparent"},get _hover(){return{bgColor:E()?"$info8":x()}},onClick:()=>{F(e.path)},get children(){return w(()=>"/"===e.path)()?"root":C(e.path)}})]}}),n(m,{get when(){return q()},get children(){return n($,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(_,{get each(){return O()?.filter(e=>e.is_dir)||[]},children:r=>n(he,{get path(){return S(e.path,r.name)}})}),n(_,{get each(){return O()?.filter(e=>!e.is_dir)||[]},children:r=>n(p,{spacing:"$2",w:"$full",get children(){return[n(l,{w:"16px"}),n(v,{get color(){return y()},as:ge,cursor:"pointer"}),n(b,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return T()===S(e.path,r.name)?"$info8":"transparent"},get _hover(){return{bgColor:T()===S(e.path,r.name)?"$info8":x()}},onClick:()=>{F(S(e.path,r.name))},get children(){return r.name}})]}})})]}})}})]}})}})},se=e=>{const r=T(),{isOpen:a,onOpen:l,onClose:o}=O(),[u,g]=t("/"),i=()=>{const r=[...e.value?e.value.split("\n"):[],u()].filter(Boolean),t=[...new Set(r)];e.onChange(t.join("\n")),o()};return n($,{w:"$full",spacing:"$2",alignItems:"stretch",get children(){return[n(p,{w:"$full",spacing:"$2",get children(){return[n(I,{get id(){return e.id},flex:"1",get value(){return e.value},get invalid(){return!e.valid},get readOnly(){return e.readOnly},get placeholder(){return e.placeholder||r("shares.files_placeholder")},onInput:r=>e.onChange(r.currentTarget.value)}),n(F,{colorScheme:"accent",get"aria-label"(){return r("global.choose_or_input_path")},get icon(){return n(ue,{})},onClick:l,size:"lg",get disabled(){return e.readOnly}})]}}),n(H,{size:"xl",get opened(){return a()},onClose:o,get children(){return[n(N,{}),n(z,{get children(){return[n(M,{}),n(P,{get children(){return r("global.choose_or_input_path")}}),n(j,{get children(){return n(ce,{forceRoot:!0,onChange:g,showHiddenFolder:!0})}}),n(R,{display:"flex",gap:"$2",get children(){return[n(B,{onClick:o,colorScheme:"neutral",get children(){return r("global.cancel")}}),n(B,{onClick:i,colorScheme:"primary",get leftIcon(){return n(ie,{})},get children(){return r("shares.add_path")}})]}})]}})]}})]}})},pe=e=>{const r=T();return n(Z,{w:"$full",display:"flex",flexDirection:"column",get required(){return e.required},get children(){return[n(q,{get for(){return e.name},display:"flex",alignItems:"center",get children(){return r(e.full_name_path??`shares.${e.name}`)}}),n(D,{get fallback(){return n(X,{get children(){return r("settings.unknown_type")}})},get children(){return[n(E,{get when(){return e.type===ne.String},get children(){return n(p,{w:"$full",spacing:"$2",get children(){return[n(J,{get id(){return e.name},type:"text",get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ne.String?r=>e.onChange?.(r.currentTarget.value):void 0}}),n(m,{get when(){return e.type===ne.String&&e.random},get children(){return n(F,{colorScheme:"neutral","aria-label":"random",get icon(){return n(de,{})},get onClick(){return e.type===ne.String?()=>e.onChange?.(e.random()):void 0}})}})]}})}}),n(E,{get when(){return e.type===ne.Number},get children(){return n(J,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ne.Number?r=>e.onChange?.(parseInt(r.currentTarget.value)):void 0}})}}),n(E,{get when(){return e.type===ne.Float},get children(){return n(J,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ne.Float?r=>e.onChange?.(parseFloat(r.currentTarget.value)):void 0}})}}),n(E,{get when(){return e.type===ne.Bool},get children(){return n(L,{get id(){return e.name},get readOnly(){return e.readonly},get defaultChecked(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ne.Bool?r=>e.onChange?.(r.currentTarget.checked):void 0}})}}),n(E,{get when(){return e.type===ne.Text},get children(){return n(I,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ne.Text?r=>e.onChange?.(r.currentTarget.value):void 0}})}}),n(E,{get when(){return e.type===ne.MultiPath},get children(){return n(se,{get id(){return e.name},get value(){return e.value},get valid(){return e.valid},get readOnly(){return e.readonly},onChange:r=>{e.type===ne.MultiPath&&e.onChange?.(r)}})}}),n(E,{get when(){return e.type===ne.Select},get children(){return n(G,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ne.Select?r=>e.onChange?.(r):void 0},get children(){return n(V,{get readonly(){return e.readonly},get searchable(){return e.type===ne.Select&&e.searchable},get options(){return e.options.split(",").map(t=>({key:t,label:r((e.options_prefix??`shares.${e.name}s`)+`.${t}`)}))}})}})}})]}})]}})};e("default",()=>{const e=T(),{params:r,back:a,to:l}=K(),{id:o}=r,[u,i]=g(()=>W.get(`/share/get?id=${o}`),!0),[d,c]=A({}),[h,s]=t(""),[p,v]=t(!1),[y,f]=t(""),[b,C]=t(!0);o&&(async()=>{const e=await i();k(e,e=>{ee(()=>{c(e),s(e.files.join("\n")),e.expires&&f(new Date(e.expires).toLocaleString()),v(!0)})})})();const[w,x]=g(()=>W.post("/share/"+(o?"update":"create"),d));return n(Y,{get loading(){return!!o&&u()},get children(){return[n(Q,{mb:"$2",get children(){return e("global."+(o?"edit":"add"))}}),n(ae,{get children(){return[n(m,{when:o,get children(){return n(pe,{name:"id",get type(){return ne.String},value:o,valid:!0,readonly:!0})}}),n(pe,{name:"files",get type(){return ne.MultiPath},get value(){return h()},get valid(){return p()},required:!0,onChange:e=>{s(e),v(e.length>0),c("files",e.split("\n"))}}),n(pe,{name:"remark",get type(){return ne.Text},get value(){return d.remark},valid:!0,onChange:e=>{c("remark",e)}}),n(pe,{name:"extract_folder",get type(){return ne.Select},get value(){return d.extract_folder},valid:!0,options:"front,back",onChange:e=>{c("extract_folder",e)}}),n(pe,{name:"order_by",get type(){return ne.Select},get value(){return d.order_by},valid:!0,options:"name,size,modified",onChange:e=>{c("order_by",e)}}),n(pe,{name:"order_direction",get type(){return ne.Select},get value(){return d.order_direction},valid:!0,options:"asc,desc",onChange:e=>{c("order_direction",e)}}),n(pe,{name:"pwd",get type(){return ne.String},get value(){return d.pwd},valid:!0,onChange:e=>{c("pwd",e)},random:re}),n(pe,{name:"max_accessed",get type(){return ne.Number},get value(){return d.max_accessed},valid:!0,onChange:e=>{c("max_accessed",e)}}),n(m,{when:o,get children(){return n(pe,{name:"accessed",get type(){return ne.Number},get value(){return d.accessed},valid:!0,onChange:e=>{c({...d,accessed:e})}})}}),n(pe,{name:"expires",get type(){return ne.String},get value(){return y()},get valid(){return b()},placeholder:"yyyy-MM-dd HH:mm:ss or +1w1d1H1m1s1ms",onChange:e=>{if(f(e),""===e)return C(!0),void c("expires",null);const r=te(e);isNaN(r.getTime())?C(!1):(C(!0),c("expires",r.toISOString()))}}),n(pe,{name:"readme",get type(){return ne.Text},get value(){return d.readme},valid:!0,onChange:e=>{c("readme",e)}}),n(pe,{name:"header",get type(){return ne.Text},get value(){return d.header},valid:!0,onChange:e=>{c("header",e)}})]}}),n(B,{mt:"$2",get disabled(){return!b()||!p()},get loading(){return w()},onClick:async()=>{const r=await x();k(r,()=>{U.success(e("global.save_success")),a()},(e,t)=>{r.data.id&&l(`/@manage/shares/edit/${r.data.id}`)})},get children(){return e("global."+(o?"save":"add"))}})]}})})}}});

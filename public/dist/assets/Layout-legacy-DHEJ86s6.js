System.register(["./index-legacy-VniDFTuT.js","./useTitle-legacy-CH79vzdE.js","./index-legacy-BbIbJMhB.js","./FolderTree-legacy-DHZp4Una.js","./index-legacy-DtNGCokM.js","./index-legacy-CqHab1CM.js","./index-legacy-DjvGcIGH.js","./index-legacy-B-ZTtTkV.js","./share-legacy-HzLthkxb.js"],function(e,t){"use strict";var r,n,o,a,l,i,c,s,d,u,g,h,p,m,b,f,_,w,y,k,v,C,x,$,S,O,z,I,M,F,j,T,W,E,L,P,A,D,H,R,N,B,U,q,K,V,Y,G,J,Q,X,Z,ee,te,re,ne,oe,ae,le,ie,ce,se,de,ue,ge,he,pe,me,be,fe,_e,we,ye,ke,ve,Ce,xe,$e,Se,Oe,ze,Ie,Me,Fe,je,Te,We,Ee,Le,Pe,Ae,De,He,Re,Ne,Be,Ue,qe,Ke,Ve,Ye,Ge,Je,Qe,Xe,Ze,et,tt,rt,nt,ot,at,lt,it,ct,st,dt,ut,gt,ht,pt,mt,bt,ft,_t,wt,yt,kt,vt,Ct,xt,$t,St,Ot,zt,It,Mt,Ft,jt,Tt,Wt,Et,Lt,Pt,At,Dt,Ht,Rt,Nt,Bt,Ut,qt,Kt,Vt,Yt,Gt,Jt,Qt,Xt,Zt,er,tr,rr,nr,or,ar,lr,ir,cr,sr,dr,ur,gr,hr,pr,mr,br,fr,_r,wr,yr,kr;return{setters:[e=>{r=e.u,n=e.g,o=e.j,a=e.k,l=e.o,i=e.q,c=e.F,s=e.r,d=e.x,u=e.y,g=e.B,h=e.z,p=e.A,m=e.C,b=e.D,f=e.S,_=e.E,w=e.G,y=e.H,k=e.I,v=e.J,C=e.Z,x=e.U,$=e.$,S=e.K,O=e.L,z=e.M,I=e.N,M=e.O,F=e.P,j=e.Q,T=e.R,W=e.T,E=e._,L=e.V,P=e.W,A=e.X,D=e.Y,H=e.a0,R=e.a1,N=e.a2,B=e.a3,U=e.a4,q=e.a5,K=e.a6,V=e.a7,Y=e.a8,G=e.a9,J=e.aa,Q=e.ab,X=e.aA,Z=e.aB,ee=e.au,te=e.am,re=e.aC,ne=e.aD,oe=e.af,ae=e.ag,le=e.aE,ie=e.ah,ce=e.an,se=e.ao,de=e.ar,ue=e.ay,ge=e.aF,he=e.aG,pe=e.aH,me=e.aI,be=e.aJ,fe=e.ad,_e=e.aK,we=e.aL,ye=e.aM,ke=e.aN,ve=e.aO,Ce=e.aP,xe=e.ac,$e=e.aQ,Se=e.aR,Oe=e.aS,ze=e.aT,Ie=e.aU,Me=e.aV,Fe=e.aW,je=e.aX,Te=e.aY,We=e.aZ,Ee=e.a_,Le=e.a$,Pe=e.b0,Ae=e.b1,De=e.b2,He=e.b3,Re=e.b4,Ne=e.b5,Be=e.b6,Ue=e.b7,qe=e.b8,Ke=e.b9,Ve=e.ba,Ye=e.bb,Ge=e.bc,Je=e.bd,Qe=e.be,Xe=e.bf,Ze=e.bg,et=e.bh,tt=e.bi,rt=e.bj,nt=e.bk,ot=e.bl,at=e.bm,lt=e.bn,it=e.bo,ct=e.bp,st=e.bq,dt=e.br,ut=e.bs,gt=e.az,ht=e.bt,pt=e.bu,mt=e.bv,bt=e.bw,ft=e.bx,_t=e.by,wt=e.bz,yt=e.bA,kt=e.bB,vt=e.bC,Ct=e.bD,xt=e.bE,$t=e.bF,St=e.bG,Ot=e.bH,zt=e.bI,It=e.ai,Mt=e.bJ,Ft=e.da,jt=e.db,Tt=e.bK,Wt=e.bL,Et=e.bM,Lt=e.bN,Pt=e.bO,At=e.bP,Dt=e.bQ,Ht=e.bS},e=>{Rt=e.u,Nt=e.a},e=>{Bt=e.L,Ut=e.C,qt=e.a,Kt=e.b,Vt=e.B,Yt=e.c,Gt=e.T,Jt=e.d,Qt=e.e,Xt=e.f,Zt=e.g,er=e.h,tr=e.i,rr=e.j,nr=e.k},e=>{or=e.F,ar=e.M},e=>{lr=e.T},e=>{ir=e.I,cr=e.u,sr=e.M,dr=e.R,ur=e.b,gr=e.c,hr=e.E,pr=e.O,mr=e.a},e=>{br=e.R},e=>{fr=e.a,_r=e.b},e=>{wr=e.r,yr=e.g,kr=e.m}],execute:function(){const vr=()=>{const{pathname:e,isShare:t}=r(),y=n(()=>{if(t()){const t=e().split("/").filter(Boolean);return[`@s/${t[1]??""}`,...t.slice(2)]}{const t=e().split("/").filter(Boolean);return["",...t.filter((e,r)=>!(0===r&&"@tenant"===e||1===r&&"data"===e&&"@tenant"===t[0]))]}}),k=u(),{setPathAs:v}=o(),C=n(()=>{const e={_after:{content:"",backgroundColor:"$background",position:"absolute",height:"100%",width:"99vw",zIndex:-1,transform:"translateX(-50%)",left:"50%",top:0}};switch(a.position_of_header_navbar){case"only_navbar_sticky":return{...e,position:"sticky",zIndex:"$sticky",top:0};case"sticky":return{...e,position:"sticky",zIndex:"$sticky",top:60};default:return{_after:void 0,position:void 0,zIndex:void 0,top:void 0}}});return l(w,i(C,{background:"$background",class:"nav",w:"$full",get children(){return l(c,{get each(){return y()},children:(e,r)=>{const o=n(()=>r()===y().length-1);let a=y().slice(0,r()+1).join("/");a&&!a.startsWith("/@tenant/data")?a="/@tenant/data"+(a.startsWith("/")?"":"/")+a:a||(a="/@tenant/data");const i=s(a);let c=()=>e;return t()||""!==c()?t()&&0===r()&&(c=()=>d("share_icon")+k("manage.sidemenu.shares")):c=()=>d("home_icon")+k("tenant.sidemenu.data"),l(g,{class:"nav-item",get children(){return[l(h,{class:"nav-link",css:{wordBreak:"break-all"},color:"unset",get _hover(){return{backgroundColor:b(),color:"unset"}},_active:{transform:"scale(.95)",transition:"0.1s"},cursor:"pointer",p:"$1",rounded:"$lg",get currentPage(){return o()},get as(){return o()?void 0:m},get href(){return p(i)},onMouseEnter:()=>v(a),get children(){return c()}}),l(f,{get when(){return!o()},get children(){return l(_,{class:"nav-separator"})}})]}})}})}}))},Cr=W(()=>D(()=>t.import("./Folder-legacy-CBC4IYyC.js"),void 0)),xr=W(()=>D(()=>t.import("./File-legacy-BQIPNcg3.js").then(e=>e.a),void 0)),$r=W(()=>D(()=>t.import("./Password-legacy-BRm1nXuf.js"),void 0)),[Sr,Or]=S(),zr=()=>{const e=u(),t=y("white","$neutral3"),{pathname:a,searchParams:i,isShare:c}=r(),{handlePathChange:s,refresh:d}=o(),g=k(),h=n(()=>"pagination"===g.type?parseInt(i.page,10)||1:void 0);let p,m;return v(C([a,h],async([e,t])=>{i.pwd&&x(i.pwd),p&&$(p,m),p=e,m=t,Rt(),await s(e,t)})),l(A,{ref:e=>Or(e),class:"obj-box",w:"$full",rounded:"$xl",get bgColor(){return t()},p:"$2",shadow:"$lg",spacing:"$2",get children(){return l(O,{get fallback(){return l(j,{})},get children(){return l(z,{get children(){return[l(I,{get when(){return F.err},get children(){return l(M,{get msg(){return F.err},disableColor:!0})}}),l(I,{get when(){return[T.FetchingObj,T.FetchingObjs].includes(F.state)},get children(){return l(j,{})}}),l(I,{get when(){return F.state===T.NeedPassword},get children(){return l($r,{get title(){return P(()=>!!c())()?e("shares.input_password"):e("home.input_password")},password:E,setPassword:x,enterCallback:()=>d(!0),get children(){return l(f,{get when(){return!c()},get children(){return[l(L,{get children(){return e("global.have_account")}}),l(L,{color:"$info9",as:Bt,get href(){return`/@login?redirect=${encodeURIComponent(location.pathname)}`},get children(){return e("global.go_login")}})]}})}})}}),l(I,{get when(){return[T.Folder,T.FetchingMore].includes(F.state)},get children(){return l(Cr,{})}}),l(I,{get when(){return F.state===T.File},get children(){return l(xr,{})}})]}})}})}})};function Ir(e){const t=y("white","$neutral3"),{proxyLink:o}=H();r();const a=n(C(()=>F.state,()=>{if(![T.FetchingMore,T.Folder,T.File].includes(F.state))return"";if([T.FetchingMore,T.Folder].includes(F.state)){const t=F.objs.find(t=>e.files.find(e=>e.toLowerCase()===t.name.toLowerCase()));if(t)return o(t,!0)}return F[e.fromMeta]&&"string"==typeof F[e.fromMeta]?F[e.fromMeta]:""})),[i]=R(a,async e=>{let t={content:e};return/^https?:\/\//g.test(e)&&(t=await K(e)),t});return l(f,{get when(){return P(()=>!!q("readme_autorender"))()&&a()},get children(){return l(N,{w:"$full",rounded:"$xl",p:"$4",get bgColor(){return t()},shadow:"$lg",get children(){return l(B,{get loading(){return i.loading},get children(){return l(U,{get children(){return i()?.content},readme:!0,get toc(){return"readme"===e.fromMeta}})}})}})}})}const Mr=e=>{const t=d("home_container");return l(z,{get fallback(){return l(N,{w:"min(99%, 980px)",get children(){return e.children}})},get children(){return l(I,{when:"hope_container"===t,get children(){return l(V,{get children(){return e.children}})}})}})};function Fr(){const{to:e}=r(),t=Y(),[n,o]=S(),[a,i]=S(),[c,s]=S(-999),d=()=>{const e=Sr(),t=a();if(!e||!t)return;const r=e.offsetLeft>50?16:0;t.clientWidth<e.offsetLeft-r?s(0):s(`calc(-100% + ${e.offsetLeft}px - ${r}px)`)};let u;return G(()=>{const e=n();e?.setPath(t.pathname),u=requestAnimationFrame(d),window.addEventListener("resize",d),Q(()=>window.removeEventListener("resize",d))}),v(C(()=>F.state,()=>{cancelAnimationFrame(u),u=requestAnimationFrame(d)})),v(C(()=>t.pathname,()=>{const e=n();e?.setPath(t.pathname)})),l(N,{get as(){return J.div},initial:{x:-999},get animate(){return{x:c()}},zIndex:"$overlay",pos:"fixed",left:3,top:3,h:"calc(100vh - 6px)",minW:180,p:"$2",overflow:"auto",shadow:"$lg",rounded:"$lg",bgColor:"white",_dark:{bgColor:"$neutral3"},onMouseEnter:()=>s(0),onMouseLeave:d,ref:e=>i(e),get children(){return l(or,{autoOpen:!0,showEmptyIcon:!0,showHiddenFolder:!1,onChange:t=>e(t),handle:e=>o(e)})}})}function jr(){const e=n(()=>"none"!==a.show_sidebar);return l(f,{get when(){return e()},get children(){return l(Fr,{})}})}const Tr=()=>l(Mr,{get children(){return l(A,{class:"body",mt:"$1",py:"$2",px:"2%",minH:"80vh",w:"$full",gap:"$4",get children(){return[l(Ir,{files:["header.md","top.md","index.md"],fromMeta:"header"}),l(vr,{}),l(zr,{}),l(Ir,{files:["readme.md","footer.md","bottom.md"],fromMeta:"readme"}),l(jr,{})]}})}}),Wr=e("o",{rename:{icon:Zt,color:"$accent9"},copy:{icon:Xt,color:"$success9"},move:{icon:Qt,color:"$warning9"},delete:{icon:Z,color:"$danger9"},decompress:{icon:Jt,color:"$neutral9"},copy_link:{icon:Gt,color:"$info9"},mkdir:{icon:qt,p:!0},recursive_move:{icon:ir,p:!0},remove_empty_directory:{icon:Kt,p:!0},batch_rename:{icon:Vt,p:!0},new_file:{icon:Ut,p:!0},cancel_select:{icon:lr},download:{icon:X,color:"$primary9"},share:{icon:Yt,color:"$primary9"}}),Er=e=>{const t=ne.findIndex(t=>t===e.name);if(-1!==t&&!oe.can(ae(),t))return null;const r=u();return l(re,{placement:"top",withArrow:!0,get label(){return r(`home.toolbar.${e.name}`)},get children(){return l(ee,i({get class(){return`toolbar-${e.name}`},get _hover(){return{bgColor:b()}},_focus:{outline:"none"},cursor:"pointer",boxSize:"$7",rounded:"$md",get p(){return Wr[e.name]?.p?"$1_5":"$1"},_active:{transform:"scale(.94)",transition:"0.2s"},get as(){return Wr[e.name]?.icon},get color(){return Wr[e.name]?.color}},e))}})},Lr=e=>{const t=u();return l(re,{get disabled(){return!e.tips},placement:"left",withArrow:!0,get label(){return t(`home.toolbar.${e.tips}`)},get children(){return l(ee,i({get color(){return te()},get _hover(){return{bgColor:te(),color:"white"}},_focus:{outline:"none"},cursor:"pointer",boxSize:"$8",rounded:"$lg",p:"$1",_active:{transform:"scale(.94)",transition:"0.2s"},get as(){return e.icon}},e))}})},Pr=()=>{const e=u(),{copySelectedPreviewPage:t,copySelectedRawLink:r}=le(),n="neutral";return l(de,{placement:"top",offset:10,get children(){return[l(ie,{as:Er,name:"copy_link"}),l(ce,{get children(){return[l(se,{colorScheme:n,onSelect:()=>{t()},get children(){return e("home.toolbar.preview_page")}}),l(se,{colorScheme:n,onSelect:()=>{r()},get children(){return e("home.toolbar.down_link")}}),l(se,{colorScheme:n,onSelect:()=>{r(!0)},get children(){return e("home.toolbar.encode_down_link")}})]}})]}})};var Ar=fe("<p>");const Dr=()=>{const e=u(),t="neutral",{batchDownloadSelected:r,sendToAria2:n,playlistDownloadSelected:o}=cr();return l(de,{placement:"top",offset:10,get children(){return[l(ie,{as:Er,name:"download"}),l(ce,{get children(){return[l(se,{colorScheme:t,onSelect:r,get children(){return e("home.toolbar.batch_download")}}),l(f,{get when(){return oe.is_admin(ae())||q("package_download")},get children(){return[l(se,{colorScheme:t,onSelect:()=>{ue.emit("tool","package_download")},get children(){return e("home.toolbar.package_download")}}),l(se,{colorScheme:t,onSelect:o,get children(){return e("home.toolbar.playlist_download")}})]}}),l(se,{colorScheme:t,onSelect:n,get children(){return e("home.toolbar.send_aria2")}})]}})]}})},Hr=W(()=>D(()=>t.import("./PackageDownload-legacy--RuUs31f.js"),void 0)),Rr=()=>{const e=u(),t=e=>{if("package_download"===e){if(!q("package_download"))return;n()}};ue.on("tool",t),Q(()=>{ue.off("tool",t)});const{isOpen:r,onOpen:n,onClose:o}=ge(),[a,i]=S("pre_tips");return l(ke,{blockScrollOnMount:!1,get opened(){return r()},onClose:o,closeOnOverlayClick:!1,closeOnEsc:!1,get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return e("home.toolbar.package_download")}}),l(O,{get fallback(){return l(j,{})},get children(){return l(f,{get when(){return"pre_tips"===a()},get fallback(){return l(Hr,{onClose:o})},get children(){return[l(be,{get children(){var t=Ar();return _e(t,()=>e("home.toolbar.pre_package_download-tips")),t}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:o,colorScheme:"neutral",get children(){return e("global.cancel")}}),l(ye,{colorScheme:"info",onClick:()=>{i("package_download")},get children(){return e("global.confirm")}})]}})]}})}})]}})]}})},Nr=()=>{const e=n(()=>[T.Folder,T.FetchingMore].includes(F.state)&&ve()&&Ce()),{isShare:t}=r();return l(Se,{exitBeforeEnter:!0,get children(){return l(f,{get when(){return e()},get children(){return l(N,{class:"center-toolbar",pos:"fixed",bottom:"$4",right:"50%",w:"max-content",color:"$neutral11",get as(){return J.div},initial:{opacity:0,scale:.9,x:"50% ",y:10},animate:{opacity:1,scale:1,x:"50%",y:0},exit:{opacity:0,scale:.9},transition:{duration:.2},get children(){return l(xe,{p:"$2",get bgColor(){return y("white","#000000d0")()},spacing:"$1",shadow:"0px 10px 30px -5px rgba(0, 0, 0, 0.3)",rounded:"$lg",css:{backdropFilter:"blur(8px)"},get children(){return[l(f,{get when(){return!t()},get children(){return l(c,{each:["rename","move","copy","delete","share","decompress"],children:e=>l(Er,{name:e,onClick:()=>{ue.emit("tool",e)}})})}}),l(Pr,{}),l(Dr,{}),l(Er,{name:"cancel_select",onClick:()=>{$e(!1)}})]}})}})}})}})},Br=()=>{const{isOpen:e,onToggle:t}=ge({defaultIsOpen:"true"===localStorage.getItem("more-open"),onClose:()=>localStorage.setItem("more-open","false"),onOpen:()=>localStorage.setItem("more-open","true")}),a=n(()=>e()?"$4":"$5"),i=n(()=>F.state===T.Folder),{refresh:c}=o(),{isShare:s}=r();return l(N,{class:"left-toolbar-box",pos:"fixed",get right(){return a()},get bottom(){return a()},get children(){return l(f,{get when(){return e()},get fallback(){return l(Lr,{class:"toolbar-toggle",as:rr,onClick:()=>{t()}})},get children(){return l(A,{class:"left-toolbar",p:"$1",rounded:"$lg",spacing:"$1",bgColor:"$neutral1",get as(){return J.div},initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6},transition:{duration:.2},get children(){return[l(A,{spacing:"$1",class:"left-toolbar-in",get children(){return[l(Lr,{as:br,tips:"refresh",onClick:()=>{c(void 0,!0)}}),l(f,{get when(){return P(()=>!(!i()||s()))()&&(ze("write")||F.write)},get children(){return[l(Lr,{get as(){return Wr.new_file.icon},tips:"new_file",onClick:()=>{ue.emit("tool","new_file")}}),l(Lr,{get as(){return Wr.mkdir.icon},p:"$1_5",tips:"mkdir",onClick:()=>{ue.emit("tool","mkdir")}}),l(Lr,{get as(){return Wr.recursive_move.icon},tips:"recursive_move",onClick:()=>{ue.emit("tool","recursiveMove")}}),l(Lr,{get as(){return Wr.remove_empty_directory.icon},tips:"remove_empty_directory",onClick:()=>{ue.emit("tool","removeEmptyDirectory")}}),l(Lr,{get as(){return Wr.batch_rename.icon},tips:"batch_rename",onClick:()=>{$e(!0),ue.emit("tool","batchRename")}}),l(Lr,{as:Oe,tips:"upload",onClick:()=>{ue.emit("tool","upload")}})]}}),l(f,{get when(){return P(()=>!(!i()||s()))()&&ze("offline_download")},get children(){return l(Lr,{as:Ie,pl:"0",tips:"offline_download",onClick:()=>{ue.emit("tool","offline_download")}})}}),l(f,{get when(){return Fe()},get children(){return l(Lr,{as:er,tips:"toggle_markdown_toc",onClick:()=>{Me(e=>!e)}})}}),l(Lr,{tips:"toggle_checkbox",as:tr,onClick:je}),l(Lr,{as:Te,tips:"local_settings",onClick:()=>{ue.emit("tool","local_settings")}})]}}),l(Lr,{tips:"more",as:rr,onClick:t})]}})}})}})},Ur=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(Ee),{pathname:s}=r(),{refresh:d}=o(),[g,h]=S(!1),p=e=>{"copy"===e&&(n(),h(!1))};return ue.on("tool",p),Q(()=>{ue.off("tool",p)}),l(ar,{get header(){return e("home.toolbar.choose_dst_folder")},get opened(){return t()},onClose:a,get loading(){return i()},get footerSlot(){return l(Ae,{mr:"auto",get checked(){return g()},onChange:()=>{h(!g())},get children(){return e("home.conflict_policy.overwrite_existing")}})},onSubmit:async e=>{let t=s();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=await c(t,e,Le().map(e=>e.name),g());Pe(r,()=>{d(),a()})}})},qr=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(De),{pathname:s}=r(),{refresh:d}=o(),[g,h]=S(!1),p=e=>{"move"===e&&(n(),h(!1))};return ue.on("tool",p),Q(()=>{ue.off("tool",p)}),l(ar,{get header(){return e("home.toolbar.choose_dst_folder")},get opened(){return t()},onClose:a,get loading(){return i()},get footerSlot(){return l(Ae,{mr:"auto",get checked(){return g()},onChange:()=>{h(!g())},get children(){return e("home.conflict_policy.overwrite_existing")}})},onSubmit:async e=>{let t=s();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=await c(t,e,Le().map(e=>e.name),g());Pe(r,()=>{d(),a()})}})};var Kr=fe("<p>");const Vr=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(He),{refresh:s}=o(),{pathname:d}=r(),g=e=>{"delete"===e&&n()};return ue.on("tool",g),Q(()=>{ue.off("tool",g)}),l(ke,{blockScrollOnMount:!1,get opened(){return t()},onClose:a,size:{"@initial":"xs","@md":"md"},get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return e("home.toolbar.delete")}}),l(be,{get children(){var t=Kr();return _e(t,()=>e("home.toolbar.delete-tips")),t}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:a,colorScheme:"neutral",get children(){return e("global.cancel")}}),l(ye,{colorScheme:"danger",get loading(){return i()},onClick:async()=>{let e=d();e.startsWith("/@tenant/data")&&(e=e.substring(13)||"/");const t=await c(e,Le().map(e=>e.name));Pe(t,()=>{s(),a()})},get children(){return e("global.confirm")}})]}})]}})]}})},Yr=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(Re),{pathname:s}=r(),{refresh:d}=o(),[g,h]=S(!1),p=e=>{if("rename"===e){if(!Be())return void ue.emit("tool","batchRename");n(),h(!1)}};return ue.on("tool",p),Q(()=>{ue.off("tool",p)}),l(f,{get when(){return t()},get children(){return l(sr,{title:"home.toolbar.input_new_name",get footerSlot(){return l(Ae,{mr:"auto",get checked(){return g()},onChange:()=>{h(!g())},get children(){return e("home.conflict_policy.overwrite_existing")}})},get isRenamingFile(){return!Le()[0].is_dir},get opened(){return t()},onClose:a,get defaultValue(){return Le()[0]?.name??""},get loading(){return i()},onSubmit:async e=>{let t=s();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=await c(Ne(t,Le()[0].name),e,g());Pe(r,()=>{d(),a()})}})}})},Gr=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(Ue),{refresh:s}=o(),{pathname:d}=r(),[g,h]=S(!1),p=e=>{"new_file"===e&&(n(),h(!1))};return ue.on("tool",p),Q(()=>{ue.off("tool",p)}),l(sr,{title:"home.toolbar.input_filename",get footerSlot(){return l(Ae,{mr:"auto",get checked(){return g()},onChange:()=>{h(!g())},get children(){return e("home.conflict_policy.overwrite_existing")}})},get opened(){return t()},onClose:a,get loading(){return i()},onSubmit:async e=>{let t=d();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=await c(Ne(t,e),E(),g());Pe(r,()=>{s(),a()})}})},Jr=()=>{const{isOpen:e,onOpen:t,onClose:n}=ge(),[a,i]=We(qe),{pathname:c}=r(),{refresh:s}=o(),d=e=>{"mkdir"===e&&t()};return ue.on("tool",d),Q(()=>{ue.off("tool",d)}),l(sr,{title:"home.toolbar.input_dir_name",get opened(){return e()},onClose:n,get loading(){return a()},onSubmit:async e=>{let t=c();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=await i(Ne(t,e));Pe(r,()=>{s(),n()})}})};var Qr=fe("<p>");const Xr=()=>{const{isOpen:e,onOpen:t,onClose:n}=ge(),{isOpen:a,onOpen:i,onClose:c}=ge(),[s,d]=We(Ke),{pathname:g}=r(),{refresh:h}=o(),[p,m]=S("cancel"),b=e=>{"recursiveMove"===e&&(t(),m("cancel"))};ue.on("tool",b),Q(()=>{ue.off("tool",b)});const f=u();return[l(ke,{blockScrollOnMount:!1,get opened(){return e()},onClose:()=>n(),size:{"@initial":"xs","@md":"md"},get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return f("home.toolbar.recursive_move")}}),l(be,{get children(){var e=Qr();return _e(e,()=>f("home.toolbar.recursive_move_directory-tips")),e}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:()=>n(),colorScheme:"neutral",get children(){return f("global.cancel")}}),l(ye,{onClick:()=>{n(),i()},colorScheme:"danger",get children(){return f("global.confirm")}})]}})]}})]}}),l(ar,{get header(){return f("home.toolbar.choose_dst_folder")},get opened(){return a()},onClose:c,get loading(){return s()},get footerSlot(){return l(xe,{mr:"auto",flex:"0.8",spacing:"$1",get children(){return l(Ve,{get value(){return p()},onChange:e=>m(e),get children(){return[l(Ye,{value:"cancel",get children(){return f("home.conflict_policy.cancel_if_exists")}}),l(Ye,{value:"overwrite",get children(){return f("home.conflict_policy.overwrite_existing")}}),l(Ye,{value:"skip",get children(){return f("home.conflict_policy.skip_existing")}})]}})}})},onSubmit:async e=>{const t=await d(g(),e,p());Pe(t,()=>{h(),c()})}})]};var Zr=fe("<p>");const en=()=>{const{isOpen:e,onOpen:t,onClose:n}=ge(),{pathname:a}=r(),[i,c]=We(Ge),{refresh:s}=o(),d=e=>{"removeEmptyDirectory"===e&&t()};ue.on("tool",d),Q(()=>{ue.off("tool",d)});const g=u();return l(ke,{blockScrollOnMount:!1,get opened(){return e()},onClose:n,size:{"@initial":"xs","@md":"md"},get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return g("home.toolbar.remove_empty_directory")}}),l(be,{get children(){var e=Zr();return _e(e,()=>g("home.toolbar.remove_empty_directory-tips")),e}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:n,colorScheme:"neutral",get children(){return g("global.cancel")}}),l(ye,{colorScheme:"danger",get loading(){return i()},onClick:async()=>{const e=await c(a());Pe(e,()=>{s(),n()})},get children(){return g("global.confirm")}})]}})]}})]}})};var tn=fe("<p>");const rn=()=>{const{isOpen:e,onOpen:t,onClose:n}=ge(),{isOpen:a,onOpen:s,onClose:d}=ge(),[g,h]=We(Je),{pathname:p}=r(),{refresh:m}=o(),[b,_]=S("1"),[w,y]=S(""),[k,v]=S(""),[C,x]=S("string"),[$,O]=S([]),z=u(),I=()=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:"left",cursor:"pointer"}),M=e=>{"batchRename"===e&&s()};ue.on("tool",M),Q(()=>{ue.off("tool",M)});const F=()=>{if(!w()||!k())return void et.warning(z("global.empty_input"));const e=new RegExp(w(),"g");let r;if("1"===b())r=Le().filter(e=>e.name.match(w())).map(t=>{const r=new Date(t.created),n=new Date(t.modified);return{src_name:t.name,new_name:t.name.replace(e,k()).replace("{created_year}",r.getFullYear().toString().padStart(4,"0")).replace("{created_month}",(r.getMonth()+1).toString().padStart(2,"0")).replace("{created_date}",r.getDate().toString().padStart(2,"0")).replace("{created_hour}",r.getHours().toString().padStart(2,"0")).replace("{created_minute}",r.getMinutes().toString().padStart(2,"0")).replace("{created_second}",r.getSeconds().toString().padStart(2,"0")).replace("{modified_year}",n.getFullYear().toString().padStart(4,"0")).replace("{modified_month}",(n.getMonth()+1).toString().padStart(2,"0")).replace("{modified_date}",n.getDate().toString().padStart(2,"0")).replace("{modified_hour}",n.getHours().toString().padStart(2,"0")).replace("{modified_minute}",n.getMinutes().toString().padStart(2,"0")).replace("{modified_second}",n.getSeconds().toString().padStart(2,"0"))}});else{let e=k();r=Le().map(t=>{let r="";const n=t.name.lastIndexOf(".");-1!==n&&(r=t.name.substring(n+1));const o={src_name:t.name,new_name:w()+e+"."+r};return e=(parseInt(e)+1).toString().padStart(e.length,"0"),o})}O(r),t(),d()};return[l(ke,{blockScrollOnMount:!1,get opened(){return a()},onClose:d,initialFocus:"#modal-input1",size:{"@initial":"xs","@md":"md"},get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return z("home.toolbar.batch_rename")}}),l(be,{get children(){return[l(Qe,{defaultValue:"1",onChange:e=>{_(e),"1"===e?x("string"):"2"===e&&x("number")},get children(){return l(xe,{spacing:"$4",get children(){return[l(Xe,{value:"1",get children(){return z("home.toolbar.regex_rename")}}),l(Xe,{value:"2",get children(){return z("home.toolbar.sequential_renaming")}})]}})}}),l(A,{spacing:"$2",get children(){return[(e=tn(),e.style.setProperty("margin","10px 0"),_e(e,l(f,{get when(){return"1"===b()},get children(){return z("home.toolbar.regular_rename")}}),null),_e(e,l(f,{get when(){return"2"===b()},get children(){return z("home.toolbar.sequential_renaming_desc")}}),null),e),l(Ze,{id:"modal-input1",type:"string",get value(){return w()},onInput:e=>{y(e.currentTarget.value)},onKeyDown:e=>{"Enter"===e.key&&F()}}),l(Ze,{id:"modal-input2",get type(){return C()},get value(){return k()},onInput:e=>{v(e.currentTarget.value)},onKeyDown:e=>{"Enter"===e.key&&F()}})];var e}})]}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:()=>{_("1"),x("string"),d()},colorScheme:"neutral",get children(){return z("global.cancel")}}),l(ye,{onClick:()=>F(),get disabled(){return!w()||!k()},get children(){return z("global.ok")}})]}})]}})]}}),l(ke,{size:"xl",get opened(){return e()},onClose:n,get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return z("home.toolbar.regex_rename_preview")}}),l(be,{get children(){return l(A,{class:"list",w:"$full",spacing:"$1",get children(){return[l(xe,{class:"title",w:"$full",p:"$2",get children(){return[l(L,i({w:{"@initial":"50%","@md":"50%"}},I,{get children(){return z("home.toolbar.regex_rename_preview_old_name")}})),l(L,i({w:{"@initial":"50%","@md":"50%"}},I,{get children(){return z("home.toolbar.regex_rename_preview_new_name")}}))]}}),l(c,{get each(){return $()},children:(e,t)=>l(dr,{obj:e,get index(){return t()}})})]}})}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{onClick:()=>{O([]),_("1"),x("string"),n(),d()},colorScheme:"neutral",get children(){return z("global.cancel")}}),l(ye,{onClick:()=>{O([]),n(),s()},colorScheme:"neutral",get children(){return z("global.back")}}),l(ye,{get loading(){return g()},onClick:async()=>{let e=p();e.startsWith("/@tenant/data")&&(e=e.substring(13)||"/");const t=await h(e,$());Pe(t,()=>{O([]),y(""),v(""),_("1"),x("string"),m(),d(),n()})},get disabled(){return 0==$().length},get children(){return z("global.ok")}})]}})]}})]}})]},nn=["upload_download_stream","delete_on_upload_succeed","delete_on_upload_failed","delete_never","delete_always"];function on(e){return gr.enc.Utf8.stringify(gr.lib.WordArray.create(e))}function an(e){const t=ur.decode(e),r=ur.encode(t.info),n=gr.SHA1(gr.lib.WordArray.create(r)).toString();let o={};return Number.isInteger(t?.info?.length)&&(o.xl=t.info.length),t.info.name&&(o.dn=on(t.info.name)),t.announce&&(o.tr=on(t.announce)),`magnet:?xt=urn:btih:${n}&${new URLSearchParams(o).toString()}`}const ln=()=>{const e=u(),[t,n]=S([]),[o,a]=We(()=>tt.get("/public/offline_download_tools")),[i,c]=S(""),[s,d]=S("upload_download_stream");G(async()=>{const e=await a();ot(e,e=>{n(e),c(e[0])})});const{isOpen:g,onOpen:h,onClose:p}=ge(),[m,b]=We(rt),{pathname:f}=r(),_=e=>{"offline_download"===e&&h()};return ue.on("tool",_),Q(()=>{ue.off("tool",_)}),l(sr,{title:"home.toolbar.offline_download",type:"text",get opened(){return g()},onClose:p,get loading(){return o()||m()},get tips(){return e("home.toolbar.offline_download-tips")},onDrop:async(e,t)=>{if(e.preventDefault(),e.dataTransfer?.files.length){const n=[];for(const t of e.dataTransfer.files)if(t.name.toLowerCase().endsWith(".torrent"))try{const e=await t.arrayBuffer();n.push(an(new Uint8Array(e)))}catch(r){console.error("Failed to convert torrent file to magnet link:",r)}n.length&&t(n.join("\n"))}},get topSlot(){return l(N,{mb:"$2",get children(){return l(nt,{get value(){return i()},onChange:e=>{"SimpleHttp"!==e&&"upload_download_stream"===s()&&d("delete_on_upload_succeed"),c(e)},get options(){return t().map(e=>({value:e,label:e}))}})}})},get bottomSlot(){return l(N,{mb:"$2",get children(){return l(nt,{get value(){return s()},onChange:e=>d(e),get options(){return nn.filter(e=>"upload_download_stream"!=e||"SimpleHttp"===i()).map(t=>({value:t,label:e(`home.toolbar.delete_policy.${t}`)}))}})}})},onSubmit:async e=>{const t=await b(f(),e.split("\n"),i(),s());Pe(t,()=>{p()})}})},cn=e=>{const t=u(),r=t=>{t===e.name&&o()};ue.on("tool",r),Q(()=>{ue.off("tool",r)});const{isOpen:n,onOpen:o,onClose:a}=ge();return l(ke,{get blockScrollOnMount(){return e.blockScrollOnMount},get opened(){return n()},onClose:a,closeOnOverlayClick:!1,closeOnEsc:!1,size:{"@initial":"xs","@md":"md","@lg":"lg","@xl":"xl","@2xl":"2xl"},get children(){return[l(he,{}),l(pe,{get children(){return[l(at,{}),l(me,{get children(){return t(e.title)}}),l(be,{get children(){return l(f,{get when(){return n()},get children(){return l(O,{get fallback(){return l(j,{})},get children(){return e.children}})}})}})]}})]}})};function sn(e){const t=u();return l(Mt,{get children(){return[l(bt,{get children(){return t(`home.local_settings.${e.key}`)}}),l(z,{get fallback(){return l(Ze,{get value(){return a[e.key]},onInput:t=>{_t(e.key,t.currentTarget.value)}})},get children(){return[l(I,{get when(){return"select"===e.type},get children(){return l(ft,{get id(){return e.key},get defaultValue(){return a[e.key]},onChange:t=>_t(e.key,t),get children(){return[l(wt,{get children(){return[l(yt,{get children(){return t("global.choose")}}),l(kt,{}),l(vt,{})]}}),l(Ct,{get children(){return l(xt,{get children(){return l(c,{get each(){return e.options},children:r=>l($t,{value:r,get children(){return[l(St,{get children(){return t(`home.local_settings.${e.key}_options.${r}`)}}),l(Ot,{})]}})})}})}})]}})}}),l(I,{get when(){return"boolean"===e.type},get children(){return l(zt,{get defaultChecked(){return"true"===a[e.key]},onChange:t=>{_t(e.key,t.currentTarget.checked.toString())}})}}),l(I,{get when(){return"number"===e.type},get children(){return l(xe,{get children(){return[l(It,{"aria-label":"decrease",get icon(){return l(fr,{})},onClick:()=>{_t(e.key,Math.max(1,parseInt(a[e.key])-1).toString())}}),l(Ze,{type:"number",get value(){return a[e.key]},onInput:t=>{_t(e.key,t.currentTarget.value)},style:{"-moz-appearance":"textfield","::-webkit-inner-spin-button":{display:"none"},"::-webkit-outer-spin-button":{display:"none"}},class:"hide-spin"}),l(It,{"aria-label":"increase",get icon(){return l(_r,{})},onClick:()=>{_t(e.key,(parseInt(a[e.key])+1).toString())}})]}})}})]}})]}})}const dn=()=>{const{isOpen:e,onOpen:t,onClose:r}=ge(),n=u(),o=e=>{"local_settings"===e&&t()};return ue.on("tool",o),Q(()=>{ue.off("tool",o)}),l(mt,{get opened(){return e()},placement:"right",onClose:r,get children(){return[l(lt,{}),l(it,{get children(){return[l(ct,{}),l(st,{color:"$info9",get children(){return n("home.toolbar.local_settings")}}),l(dt,{get children(){return[l(A,{spacing:"$2",get children(){return l(c,{get each(){return ut.filter(e=>!e.hidden)},children:e=>l(sn,e)})}}),l(gt,{mt:"$4",get children(){return l(xe,{spacing:"$4",p:"$2",color:"$neutral11",get children(){return[l(ht,{}),l(pt,{})]}})}})]}})]}})]}})},un=()=>{if(Ft)return null;const[e,t]=S(!1);var r;return r=()=>t(window.scrollY>100),window.addEventListener("scroll",r,{passive:!0}),Q(()=>window.removeEventListener("scroll",r)),l(f,{get when(){return e()},get children(){return l(N,{get as(){return J.div},initial:{y:-999},animate:{y:0},zIndex:"$overlay",pos:"fixed",right:"$5",top:"0",borderBottomRadius:"50%",bgColor:"$whiteAlpha12",get color(){return te()},overflow:"hidden",shadow:"$lg",get _dark(){return{bgColor:te(),color:"white"}},get _hover(){return{bgColor:te(),color:"white"}},get children(){return l(ee,{_focus:{outline:"none"},cursor:"pointer",boxSize:"$7",p:"$1",rounded:"$lg",as:jt,onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})}})}})}})};var gn=fe("<div>");const hn=()=>{const e=u(),{isOpen:t,onOpen:n,onClose:a}=ge(),[i,c]=We(Tt),{pathname:s}=r(),{refresh:d}=o(),[g,h]=S(""),[p,m]=S(""),[b,f]=S(!0),[_,w]=S(!1),y=e=>{"decompress"===e&&(Wt(()=>{f(!0),h("/"),m("")}),n())},k=e=>{const{inner:t,pass:r}=JSON.parse(e);Wt(()=>{f(!1),h(t),m(r)}),n()};return ue.on("tool",y),ue.on("extract",k),Q(()=>{ue.off("tool",y),ue.off("extract",k)}),l(ar,{get header(){return"/"===g()?e("home.toolbar.choose_dst_folder"):e("home.toolbar.archive.extract_header",{path:g()})},get opened(){return t()},onClose:a,get loading(){return i()},onSubmit:async e=>{const{path:t,name:r}=(()=>{let e=s();if(e.startsWith("/@tenant/data")&&(e=e.substring(13)||"/"),"/"===g())return{path:e,name:Le().map(e=>e.name)};{let t=e.lastIndexOf("/");return{path:e.slice(0,t),name:[e.slice(t+1)]}}})(),n=await c(t,e,r,p(),g(),b(),_());Pe(n,()=>{d(),a()})},get children(){return l(A,{spacing:"$1",alignItems:"flex-start",get children(){return[l(xe,{width:"100%",spacing:"$1",get children(){return[l(L,{size:"sm",css:{whiteSpace:"nowrap"},get children(){return e("home.toolbar.decompress-pass")}}),l(Ze,{get value(){return p()},onInput:e=>m(e.target.value),size:"sm",flexGrow:"1"})]}}),l(Ae,{get checked(){return b()},onChange:e=>f(e.target.checked),get children(){return e("home.toolbar.decompress-cache-full")}}),l(Ae,{get checked(){return _()},onChange:e=>w(e.target.checked),get children(){return e("home.toolbar.decompress-put-into-new")}}),gn()]}})}})},pn=()=>{const e=u(),[t,n]=S(""),{pathname:o}=r(),a=e=>{"share"===e&&(Wt(()=>{n(""),p(""),b(!0);const e=Le().map(e=>{let t=o();t.startsWith("/@tenant/data")&&(t=t.substring(13)||"/");const r=t.endsWith("/")||e.name.startsWith("/")?"":"/";return`${ae().base_path}${t}${r}${e.name}`});_({files:e,expires:null,pwd:"",max_accessed:0,order_by:pr.None,order_direction:mr.None,extract_folder:hr.None,remark:"",readme:"",header:""})}),c())};ue.on("tool",a),Q(()=>{ue.off("tool",a)});const{isOpen:i,onOpen:c,onClose:s}=ge(),{copy:g}=Et(),[h,p]=S(""),[m,b]=S(!0),[f,_]=Lt({}),[w,y]=We(()=>tt.post("/share/create",f));return l(ke,{blockScrollOnMount:!1,get opened(){return i()},onClose:s,size:{"@initial":"xs","@md":"md","@lg":"lg","@xl":"xl","@2xl":"2xl"},get children(){return[l(he,{}),l(pe,{get children(){return[l(me,{get children(){return e("home.toolbar.share")}}),l(zt,{get fallback(){return[l(be,{get children(){return l(Pt,{variant:"filled",get value(){return t()},readonly:!0})}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{colorScheme:"primary",onClick:()=>{g(t())},get children(){return e("shares.copy_msg")}}),l(ye,{colorScheme:"info",onClick:s,get children(){return e("global.confirm")}})]}})]},get children(){return l(I,{get when(){return""===t()},get children(){return[l(be,{get children(){return l(A,{spacing:"$1",alignItems:"flex-start",get children(){return[l(L,{size:"sm",get children(){return e("shares.remark")}}),l(Pt,{size:"sm",get value(){return f.remark},onInput:e=>{_("remark",e.currentTarget.value)}}),l(L,{size:"sm",get children(){return e("shares.extract_folder")}}),l(ft,{size:"sm",get value(){return f.extract_folder},onChange:e=>{_("extract_folder",e)},get children(){return l(At,{get options(){return[{key:hr.Front,label:e("shares.extract_folders.front")},{key:hr.Back,label:e("shares.extract_folders.back")}]}})}}),l(L,{size:"sm",get children(){return e("shares.order_by")}}),l(ft,{size:"sm",get value(){return f.order_by},onChange:e=>{_("order_by",e)},get children(){return l(At,{get options(){return[{key:pr.Name,label:e("shares.order_bys.name")},{key:pr.Size,label:e("shares.order_bys.size")},{key:pr.Modified,label:e("shares.order_bys.modified")}]}})}}),l(L,{size:"sm",get children(){return e("shares.order_direction")}}),l(ft,{size:"sm",get value(){return f.order_direction},onChange:e=>{_("order_direction",e)},get children(){return l(At,{get options(){return[{key:mr.Asc,label:e("shares.order_directions.asc")},{key:mr.Desc,label:e("shares.order_directions.desc")}]}})}}),l(L,{size:"sm",get children(){return e("shares.pwd")}}),l(xe,{spacing:"$1",w:"$full",get children(){return[l(Ze,{size:"sm",get value(){return f.pwd},onInput:e=>{_("pwd",e.currentTarget.value)}}),l(It,{colorScheme:"neutral",size:"sm","aria-label":"random",get icon(){return l(nr,{})},onClick:()=>{_("pwd",wr())}})]}}),l(L,{size:"sm",get children(){return e("shares.max_accessed")}}),l(Ze,{type:"number",size:"sm",get value(){return f.max_accessed},onInput:e=>{_("max_accessed",parseInt(e.currentTarget.value))}}),l(L,{size:"sm",get children(){return e("shares.expires")}}),l(Ze,{size:"sm",get invalid(){return!m()},get value(){return h()},placeholder:"yyyy-MM-dd HH:mm:ss or +1w1d1H1m1s1ms",onInput:e=>{if(p(e.currentTarget.value),""===e.currentTarget.value)return b(!0),void _("expires",null);const t=yr(e.currentTarget.value);isNaN(t.getTime())?b(!1):(b(!0),_("expires",t))}}),l(L,{size:"sm",get children(){return e("shares.readme")}}),l(Pt,{size:"sm",get value(){return f.readme},onInput:e=>{_("readme",e.currentTarget.value)}}),l(L,{size:"sm",get children(){return e("shares.header")}}),l(Pt,{size:"sm",get value(){return f.header},onInput:e=>{_("header",e.currentTarget.value)}})]}})}}),l(we,{display:"flex",gap:"$2",get children(){return[l(ye,{colorScheme:"neutral",onClick:s,get children(){return e("global.cancel")}}),l(ye,{get loading(){return w()},onClick:async()=>{const e=await y();ot(e,e=>{n(`${location.origin}${Dt(d("share_template"),kr(e))}`)})},get children(){return e("global.ok")}})]}})]}})}})]}})]}})},mn=W(()=>D(()=>t.import("./Upload-legacy-B1MdcL_l.js"),void 0)),bn=()=>[l(Ur,{}),l(qr,{}),l(Yr,{}),l(Vr,{}),l(hn,{}),l(Gr,{}),l(Jr,{}),l(pn,{}),l(Xr,{}),l(en,{}),l(rn,{}),l(ln,{}),l(Rr,{}),l(cn,{name:"upload",title:"home.toolbar.upload",get children(){return l(mn,{})}}),l(dn,{})],fn=()=>l(Ht,{get children(){return[l(Br,{}),l(Nr,{}),l(bn,{}),l(un,{})]}}),_n=Object.freeze(Object.defineProperty({__proto__:null,default:()=>(Nt(d("site_title")),[l(fn,{}),l(Tr,{})])},Symbol.toStringTag,{value:"Module"}));e("L",_n)}}});

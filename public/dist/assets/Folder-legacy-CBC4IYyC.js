System.register(["./index-legacy-VniDFTuT.js","./style-legacy-BcLYXFbK.js","./index-legacy-CqHab1CM.js","./Layout-legacy-DHEJ86s6.js","./icon-legacy-DffONu1z.js","./video_box-legacy-CdsU8UJB.js","./Paginator-legacy-WiRdw-U0.js","./mark-legacy-c975BiXg.js","./index-legacy-BbIbJMhB.js","./useTitle-legacy-CH79vzdE.js","./FolderTree-legacy-DHZp4Una.js","./index-legacy-DtNGCokM.js","./index-legacy-DjvGcIGH.js","./index-legacy-B-ZTtTkV.js","./share-legacy-HzLthkxb.js","./artplayer-legacy-0yEpccra.js"],function(e,r){"use strict";var n,t,o,a,l,i,c,d,s,u,g,h,m,p,y,w,b,k,f,_,$,v,x,C,j,S,z,I,E,L,M,P,D,O,T,F,A,K,R,W,B,G,J,N,Z,H,V,q,Q,X,Y,U,ee,re,ne,te,oe,ae,le,ie,ce,de,se,ue,ge,he,me,pe,ye,we,be,ke,fe,_e,$e,ve,xe,Ce,je,Se,ze,Ie,Ee,Le,Me;return{setters:[e=>{n=e.co,t=e.aE,o=e.a0,a=e.u,l=e.o,i=e.F,c=e.ay,d=e.aD,s=e.af,u=e.ag,g=e.a$,h=e.cp,m=e.S,p=e.bh,y=e.y,w=e.ac,b=e.as,k=e.V,f=e.cq,_=e.au,$=e.cr,v=e.b6,x=e.a5,C=e.W,j=e.aP,S=e.N,z=e.Q,I=e.P,E=e.R,L=e.I,M=e.M,P=e.cs,D=e.ct,O=e.j,T=e.aM,F=e.a9,A=e.ab,K=e.aF,R=e.K,W=e.aZ,B=e.cu,G=e.aG,J=e.aH,N=e.bm,Z=e.aI,H=e.aJ,V=e.X,q=e.bk,Q=e.bg,X=e.ai,Y=e.av,U=e.aN,ee=e.aw,re=e._,ne=e.bl,te=e.r,oe=e.b5,ae=e.am,le=e.ck,ie=e.cl,ce=e.D,de=e.cv,se=e.g,ue=e.J,ge=e.Z,he=e.T,me=e.aj,pe=e.Y},e=>{ye=e.x,we=e.C,be=e.w},e=>{ke=e.u},e=>{fe=e.o},e=>{_e=e.O,$e=e.g},e=>{ve=e.p},e=>{xe=e.P},e=>{Ce=e.M,je=e.l,Se=e.Z,ze=e.T,Ie=e.R,Ee=e.A,Le=e.F},e=>{Me=e.L},null,null,null,null,null,null,null],execute:function(){const Pe=e=>{const r=y();return l(w,{spacing:"$2",get children(){return[l(_,{get p(){return fe[e.name].p?"$1":void 0},get as(){return fe[e.name].icon},boxSize:"$7",get color(){return fe[e.name].color}}),l(k,{get children(){return r(`home.toolbar.${e.name}`)}})]}})},De=()=>{const e=y(),{colorMode:r}=n(),{copySelectedRawLink:S,copySelectedPreviewPage:z}=t(),{batchDownloadSelected:I,sendToAria2:E,playlistDownloadSelected:L}=ke(),{rawLink:M}=o(),{isShare:P}=a();return l(be,{id:1,animation:"scale",get theme(){return"dark"!==r()?"light":"dark"},style:"z-index: var(--hope-zIndices-popover)",get children(){return[l(i,{each:["rename","move","copy","delete","share"],children:e=>l(ye,{hidden:()=>{const r=d.findIndex(r=>r===e);return P()||!s.can(u(),r)},onClick:()=>{c.emit("tool",e)},get children(){return l(Pe,{name:e})}})}),l(ye,{hidden:()=>{const e=d.findIndex(e=>"decompress"===e);return P()||!s.can(u(),e)||g().some(e=>e.is_dir)||g().some(e=>!h(e.name))},onClick:()=>{c.emit("tool","decompress")},get children(){return l(Pe,{name:"decompress"})}}),l(m,{get when(){return v()},get children(){return[l(ye,{onClick:({props:e})=>{e.is_dir?z():S(!0)},get children(){return l(Pe,{name:"copy_link"})}}),l(ye,{onClick:({props:r})=>{if(r.is_dir){if(!s.is_admin(u())&&!x("package_download"))return void p.warning(e("home.toolbar.package_download_disabled"));c.emit("tool","package_download")}else I()},get children(){return l(Pe,{name:"download"})}}),l(we,{hidden:({props:e})=>e.type!==_e.VIDEO,get label(){return l(w,{spacing:"$2",get children(){return[l(_,{as:$,boxSize:"$7",p:"$0_5",color:"$info9"}),l(k,{get children(){return e("home.preview.play_with")}})]}})},get children(){return l(i,{each:ve,children:e=>l(ye,{onClick:({props:r})=>{const n=f(e.scheme,{raw_url:"",name:r.name,d_url:M(r,!0)});window.open(n,"_self")},get children(){return l(w,{spacing:"$2",get children(){return[l(b,{m:"0 auto",boxSize:"$7",get src(){return`${window.__dynamic_base__}/images/${e.icon}.webp`}}),l(k,{get children(){return e.name}})]}})}})})}})]}}),l(m,{get when(){return C(()=>!v())()&&j()},get children(){return[l(we,{get label(){return l(Pe,{name:"copy_link"})},get children(){return[l(ye,{onClick:z,get children(){return e("home.toolbar.preview_page")}}),l(ye,{onClick:()=>S(),get children(){return e("home.toolbar.down_link")}}),l(ye,{onClick:()=>S(!0),get children(){return e("home.toolbar.encode_down_link")}})]}}),l(we,{get label(){return l(Pe,{name:"download"})},get children(){return[l(ye,{onClick:I,get children(){return e("home.toolbar.batch_download")}}),l(m,{get when(){return s.is_admin(u())||x("package_download")},get children(){return[l(ye,{onClick:()=>c.emit("tool","package_download"),get children(){return e("home.toolbar.package_download")}}),l(ye,{onClick:L,get children(){return e("home.toolbar.playlist_download")}})]}}),l(ye,{onClick:E,get children(){return e("home.toolbar.send_aria2")}})]}})]}})]}})},Oe=()=>{const e=L(),{pathname:r,setSearchParams:n}=a();return l(xe,{get total(){return I.total},get defaultCurrent(){return D()},get defaultPageSize(){return e.size},onChange:e=>{P(r(),e),n({page:e})}})},Te=()=>{const{loadMore:e,allLoaded:r}=O(),n=y();return l(m,{get when(){return!r()},get fallback(){return l(k,{fontStyle:"italic",get children(){return n("home.no_more")}})},get children(){return l(T,{onClick:e,get children(){return n("home.load_more")}})}})},Fe=()=>{const{loadMore:e,allLoaded:r}=O(),n=y(),t=new IntersectionObserver(r=>{r[0].isIntersecting&&e()},{threshold:.1});let o;return F(()=>{r()||t.observe(o)}),A(()=>{t.disconnect()}),l(m,{get when(){return!r()},get fallback(){return l(k,{fontStyle:"italic",get children(){return n("home.no_more")}})},get children(){return l(z,{py:"$2",size:"md",thickness:3,ref(e){"function"==typeof o?o(e):o=e}})}})},Ae=()=>{const e=L();return l(M,{get children(){return[l(S,{get when(){return I.state===E.FetchingMore},get children(){return l(z,{py:"$2",size:"md",thickness:3})}}),l(S,{get when(){return"pagination"===e.type},get children(){return l(Oe,{})}}),l(S,{get when(){return"load_more"===e.type},get children(){return l(Te,{})}}),l(S,{get when(){return"auto_load_more"===e.type},get children(){return l(Fe,{})}})]}})};function Ke(e){let r;return F(()=>{new Ce(r).mark(e.keywords,{separateWordSearch:!0,diacritics:!0})}),l(de.span,{ref(e){"function"==typeof r?r(e):r=e},css:{mark:{bg:"$info4",rounded:"$md",px:"1px",color:"$info11",fontWeight:"$bold"}},get children(){return e.name}})}const Re=e=>{const{setPathAs:r}=O();return l(w,{w:"$full",get borderBottom(){return`1px solid ${ce()}`},get _hover(){return{bgColor:ce()}},rounded:"$md",cursor:"pointer",px:"$2",as:Me,get href(){return`${e.node.path}?from=search`},onMouseEnter:()=>{r(e.node.path,e.node.is_dir)},get children(){return[l(_,{class:"icon",boxSize:"$6",get color(){return ae()},get as(){return $e(e.node)},mr:"$1"}),l(V,{flex:1,p:"$1",spacing:"$1",w:"$full",alignItems:"start",get children(){return[l(k,{css:{wordBreak:"break-all"},get children(){return[l(Ke,{get keywords(){return e.keywords},get name(){return e.node.name}}),l(m,{get when(){return e.node.size>0||!e.node.is_dir},get children(){return l(le,{colorScheme:"info",ml:"$2",get children(){return ie(e.node.size)}})}})]}}),l(k,{color:"$neutral10",size:"xs",css:{wordBreak:"break-all"},get children(){return e.node.parent}})]}})]}})},We=()=>{const{isOpen:e,onOpen:r,onClose:n,onToggle:t}=K(),o=y(),d=e=>{"search"===e&&r()};c.on("tool",d);const s=e=>{(e.ctrlKey||ee&&e.metaKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),t())};document.addEventListener("keydown",s),A(()=>{c.off("tool",d),document.removeEventListener("keydown",s)});const[g,h]=R(""),{pathname:m}=a(),[p,b]=W(B),[f,_]=R({content:[],total:0}),[$,v]=R(0),x=["all","folder","file"];let C;const j=async(e=1)=>{if(1===e&&C?.(),p())return;_({content:[],total:0});const r=await b(m(),g(),re(),$(),e,100);ne(r,e=>{const r=e.content;r&&(r.forEach(e=>{if(u().base_path&&e.parent.startsWith(u().base_path)){const r=new RegExp("^"+u().base_path);e.parent=e.parent.replace(r,"")||"/",e.parent.startsWith("/")||(e.parent="/"+e.parent)}e.path=te(oe(e.parent,e.name))}),_(e))})};return l(U,{get opened(){return e()},onClose:n,closeOnEsc:!1,size:{"@initial":"sm","@sm":"lg","@md":"2xl"},initialFocus:"#search-input",scrollBehavior:"inside",get children(){return[l(G,{bg:"$blackAlpha5"}),l(J,{mx:"$2",get children(){return[l(N,{}),l(Z,{get children(){return o("home.search.search")}}),l(H,{get children(){return l(V,{w:"$full",spacing:"$2",get children(){return[l(w,{w:"$full",spacing:"$2",get children(){return[l(q,{w:"$32",get value(){return $()},onChange:e=>v(e),get options(){return x.map((e,r)=>({value:r,label:o(`home.search.scopes.${e}`)}))}}),l(Q,{id:"search-input",get value(){return g()},onInput:e=>{h(e.currentTarget.value)},onKeyDown:e=>{"Enter"===e.key&&0!==g().length&&j()}}),l(X,{flexShrink:0,"aria-label":"search",get icon(){return l(Y,{})},onClick:()=>j(),get loading(){return p()},get disabled(){return 0===g().length}})]}}),l(M,{get children(){return[l(S,{get when(){return p()},get children(){return l(z,{})}}),l(S,{get when(){return 0===f().content.length},get children(){return l(k,{size:"2xl",my:"$8",get children(){return o("home.search.no_result")}})}})]}}),l(V,{w:"$full",get children(){return l(i,{get each(){return f().content},children:e=>l(Re,{node:e,get keywords(){return g()}})})}}),l(xe,{get total(){return f().total},defaultPageSize:100,onChange:e=>{j(e)},setResetCallback:e=>C=e})]}})}})]}})]}})},Be=he(()=>pe(()=>r.import("./List-legacy-DDCqFnUS.js"),void 0)),Ge=he(()=>pe(()=>r.import("./Grid-legacy-D0CjtrTU.js"),void 0)),Je=he(()=>pe(()=>r.import("./Images-legacy-DhJEvLmH.js"),void 0));e("default",()=>{const{rawLink:e}=o(),r=se(()=>I.objs.filter(e=>e.type===_e.IMAGE));let n;return ue(ge(r,()=>{n?.destroy(),n=void 0})),c.on("gallery",t=>{n||(n=je(document.createElement("div"),{addClass:"lightgallery-container",dynamic:!0,thumbnail:!0,plugins:[Se,ze,Ie,Ee,Le],dynamicEl:r().map(r=>{const n=e(r,!0);return{src:n,thumb:""===r.thumb?n:r.thumb,subHtml:`<h4>${r.name}</h4>`}})})),n?.openGallery(r().findIndex(e=>e.name===t))}),A(()=>{c.off("gallery"),n?.destroy()}),[l(M,{get children(){return[l(S,{get when(){return"list"===me()},get children(){return l(Be,{})}}),l(S,{get when(){return"grid"===me()},get children(){return l(Ge,{})}}),l(S,{get when(){return"image"===me()},get children(){return l(Je,{get images(){return r()}})}})]}}),l(Ae,{}),l(We,{}),l(De,{})]})}}});

System.register(["./index-legacy-BmFN10UP.js","./share-legacy-BsZqm-Ki.js","./ResponsiveGrid-legacy-BiG98N-A.js","./index-legacy-LK5MDoR8.js"],function(e,r){"use strict";var t,n,a,l,o,u,g,i,d,c,h,s,p,m,v,y,f,C,b,w,x,$,_,S,k,O,T,I,H,z,F,R,j,M,N,P,B,E,q,D,A,G,L,X,Y,J,K,U,W,Z,Q,V,ee,re,te,ne,ae,le,oe,ue,ge,ie,de;return{setters:[e=>{t=e.B,n=e.D,a=e.dq,l=e.al,o=e.bX,u=e.dr,g=e.b9,i=e.A,d=e._,c=e.ds,h=e.C,s=e.ah,p=e.au,m=e.S,v=e.aM,y=e.aE,f=e.dj,C=e.ad,b=e.k,w=e.ae,x=e.$,$=e.af,_=e.R,S=e.z,k=e.bw,O=e.aY,T=e.T,I=e.o,H=e.aA,z=e.L,F=e.M,R=e.E,j=e.bx,M=e.F,N=e.G,P=e.J,B=e.K,E=e.bH,q=e.a5,D=e.a6,A=e.I,G=e.bT,L=e.bI,X=e.bZ,Y=e.aR,J=e.bU,K=e.g,U=e.bt,W=e.bY,Z=e.c3,Q=e.r,V=e.am,ee=e.bW},e=>{re=e.r,te=e.g},e=>{ne=e.T,ae=e.R},e=>{le=e.l,oe=e.x,ue=e.y,ge=e.z,ie=e.D,de=e.k}],execute:function(){const r=a(),ce=e=>{const[a,o]=t("/");return e.handle?.({setPath:o}),n(l,{class:"folder-tree-box",w:"$full",overflowX:"auto",get children(){return n(r.Provider,{get value(){return{value:a,onChange:r=>{o(r),e.onChange(r)},autoOpen:e.autoOpen??!1,forceRoot:e.forceRoot??!1,showEmptyIcon:e.showEmptyIcon??!1,showHiddenFolder:e.showHiddenFolder??!0}},get children(){return n(he,{path:"/"})}})}})},he=e=>{const{isHidePath:a}=o(),[O,T]=t(),{value:I,onChange:H,forceRoot:z,autoOpen:F,showEmptyIcon:R,showHiddenFolder:j}=u(r),[M,N]=g(()=>i(e.path,d(),1,0,!1));let P=!1;const B=async()=>{if(O()?.length)return;const e=await N();k(e,e=>{P=!0,T(e.content||[])},()=>{E()&&q()})},{isOpen:E,onToggle:q}=function(){const[e,r]=t(!1);return{isOpen:e,onToggle:()=>r(!e()),onOpen:()=>r(!0),onClose:()=>r(!1)}}(),D=()=>I()===e.path,A=c(e.path);return h(s(I,async e=>{F&&A(e)&&(E()||q(),P||B())})),n(m,{get when(){return j||!(a(e.path)&&!A(I()))},get children(){return n(l,{get children(){return[n(p,{spacing:"$2",get children(){return[n(m,{get when(){return!M()},get fallback(){return n(f,{size:"sm",get color(){return y()}})},get children(){return n(m,{get when(){return!Boolean(R&&void 0!==O()&&!O()?.length)},get fallback(){return n(v,{get color(){return y()},as:oe})},get children(){return n(v,{get color(){return y()},as:le,get transform(){return E()?"rotate(90deg)":"none"},transition:"transform 0.2s",cursor:"pointer",onClick:()=>{q(),E()&&B()}})}})}}),n(v,{get color(){return y()},as:ue,cursor:"pointer"}),n(C,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return D()?"$info8":"transparent"},get _hover(){return{bgColor:D()?"$info8":x()}},onClick:()=>{H(e.path)},get children(){return w(()=>"/"===e.path)()?"root":b(e.path)}})]}}),n(m,{get when(){return E()},get children(){return n($,{mt:"$1",pl:"$4",alignItems:"start",spacing:"$1",get children(){return[n(_,{get each(){return O()?.filter(e=>e.is_dir)||[]},children:r=>n(he,{get path(){return S(e.path,r.name)}})}),n(_,{get each(){return O()?.filter(e=>!e.is_dir)||[]},children:r=>n(p,{spacing:"$2",w:"$full",get children(){return[n(l,{w:"16px"}),n(v,{get color(){return y()},as:ge,cursor:"pointer"}),n(C,{css:{whiteSpace:"nowrap"},fontSize:"$md",cursor:"pointer",px:"$1",rounded:"$md",get bgColor(){return I()===S(e.path,r.name)?"$info8":"transparent"},get _hover(){return{bgColor:I()===S(e.path,r.name)?"$info8":x()}},onClick:()=>{H(S(e.path,r.name))},get children(){return r.name}})]}})})]}})}})]}})}})},se=e=>{const r=I(),{isOpen:a,onOpen:l,onClose:o}=O(),[u,g]=t("/"),i=()=>{const r=[...e.value?e.value.split("\n"):[],u()].filter(Boolean),t=[...new Set(r)];e.onChange(t.join("\n")),o()};return n($,{w:"$full",spacing:"$2",alignItems:"stretch",get children(){return[n(p,{w:"$full",spacing:"$2",get children(){return[n(T,{get id(){return e.id},flex:"1",get value(){return e.value},get invalid(){return!e.valid},get readOnly(){return e.readOnly},get placeholder(){return e.placeholder||r("shares.files_placeholder")},onInput:r=>e.onChange(r.currentTarget.value)}),n(H,{colorScheme:"accent",get"aria-label"(){return r("global.choose_or_input_path")},get icon(){return n(ue,{})},onClick:l,size:"lg",get disabled(){return e.readOnly}})]}}),n(z,{size:"xl",get opened(){return a()},onClose:o,get children(){return[n(F,{}),n(R,{get children(){return[n(j,{}),n(M,{get children(){return r("global.choose_or_input_path")}}),n(N,{get children(){return n(ce,{forceRoot:!0,onChange:g,showHiddenFolder:!0})}}),n(P,{display:"flex",gap:"$2",get children(){return[n(B,{onClick:o,colorScheme:"neutral",get children(){return r("global.cancel")}}),n(B,{onClick:i,colorScheme:"primary",get leftIcon(){return n(ie,{})},get children(){return r("shares.add_path")}})]}})]}})]}})]}})},pe=e=>{const r=I();return n(J,{w:"$full",display:"flex",flexDirection:"column",get required(){return e.required},get children(){return[n(E,{get for(){return e.name},display:"flex",alignItems:"center",get children(){return r(e.full_name_path??`shares.${e.name}`)}}),n(q,{get fallback(){return n(Y,{get children(){return r("settings.unknown_type")}})},get children(){return[n(D,{get when(){return e.type===ne.String},get children(){return n(p,{w:"$full",spacing:"$2",get children(){return[n(A,{get id(){return e.name},type:"text",get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ne.String?r=>e.onChange?.(r.currentTarget.value):void 0}}),n(m,{get when(){return e.type===ne.String&&e.random},get children(){return n(H,{colorScheme:"neutral","aria-label":"random",get icon(){return n(de,{})},get onClick(){return e.type===ne.String?()=>e.onChange?.(e.random()):void 0}})}})]}})}}),n(D,{get when(){return e.type===ne.Number},get children(){return n(A,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ne.Number?r=>e.onChange?.(parseInt(r.currentTarget.value)):void 0}})}}),n(D,{get when(){return e.type===ne.Float},get children(){return n(A,{type:"number",get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onInput(){return e.type===ne.Float?r=>e.onChange?.(parseFloat(r.currentTarget.value)):void 0}})}}),n(D,{get when(){return e.type===ne.Bool},get children(){return n(G,{get id(){return e.name},get readOnly(){return e.readonly},get defaultChecked(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ne.Bool?r=>e.onChange?.(r.currentTarget.checked):void 0}})}}),n(D,{get when(){return e.type===ne.Text},get children(){return n(T,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get placeholder(){return e.placeholder},get onChange(){return e.type===ne.Text?r=>e.onChange?.(r.currentTarget.value):void 0}})}}),n(D,{get when(){return e.type===ne.MultiPath},get children(){return n(se,{get id(){return e.name},get value(){return e.value},get valid(){return e.valid},get readOnly(){return e.readonly},onChange:r=>{e.type===ne.MultiPath&&e.onChange?.(r)}})}}),n(D,{get when(){return e.type===ne.Select},get children(){return n(L,{get id(){return e.name},get readOnly(){return e.readonly},get value(){return e.value},get invalid(){return!e.valid},get onChange(){return e.type===ne.Select?r=>e.onChange?.(r):void 0},get children(){return n(X,{get readonly(){return e.readonly},get searchable(){return e.type===ne.Select&&e.searchable},get options(){return e.options.split(",").map(t=>({key:t,label:r((e.options_prefix??`shares.${e.name}s`)+`.${t}`)}))}})}})}})]}})]}})};e("default",()=>{const e=I(),{params:r,back:a,to:l}=K(),{id:o}=r,[u,i]=g(()=>U.get(`/share/get?id=${o}`),!0),[d,c]=W({}),[h,s]=t(""),[p,v]=t(!1),[y,f]=t(""),[C,b]=t(!0);o&&(async()=>{const e=await i();k(e,e=>{ee(()=>{c(e),s(e.files.join("\n")),e.expires&&f(new Date(e.expires).toLocaleString()),v(!0)})})})();const[w,x]=g(()=>U.post("/share/"+(o?"update":"create"),d));return n(V,{get loading(){return!!o&&u()},get children(){return[n(Z,{mb:"$2",get children(){return e("global."+(o?"edit":"add"))}}),n(ae,{get children(){return[n(m,{when:o,get children(){return n(pe,{name:"id",get type(){return ne.String},value:o,valid:!0,readonly:!0})}}),n(pe,{name:"files",get type(){return ne.MultiPath},get value(){return h()},get valid(){return p()},required:!0,onChange:e=>{s(e),v(e.length>0),c("files",e.split("\n"))}}),n(pe,{name:"remark",get type(){return ne.Text},get value(){return d.remark},valid:!0,onChange:e=>{c("remark",e)}}),n(pe,{name:"extract_folder",get type(){return ne.Select},get value(){return d.extract_folder},valid:!0,options:"front,back",onChange:e=>{c("extract_folder",e)}}),n(pe,{name:"order_by",get type(){return ne.Select},get value(){return d.order_by},valid:!0,options:"name,size,modified",onChange:e=>{c("order_by",e)}}),n(pe,{name:"order_direction",get type(){return ne.Select},get value(){return d.order_direction},valid:!0,options:"asc,desc",onChange:e=>{c("order_direction",e)}}),n(pe,{name:"pwd",get type(){return ne.String},get value(){return d.pwd},valid:!0,onChange:e=>{c("pwd",e)},random:re}),n(pe,{name:"max_accessed",get type(){return ne.Number},get value(){return d.max_accessed},valid:!0,onChange:e=>{c("max_accessed",e)}}),n(m,{when:o,get children(){return n(pe,{name:"accessed",get type(){return ne.Number},get value(){return d.accessed},valid:!0,onChange:e=>{c({...d,accessed:e})}})}}),n(pe,{name:"expires",get type(){return ne.String},get value(){return y()},get valid(){return C()},placeholder:"yyyy-MM-dd HH:mm:ss or +1w1d1H1m1s1ms",onChange:e=>{if(f(e),""===e)return b(!0),void c("expires",null);const r=te(e);isNaN(r.getTime())?b(!1):(b(!0),c("expires",r.toISOString()))}}),n(pe,{name:"readme",get type(){return ne.Text},get value(){return d.readme},valid:!0,onChange:e=>{c("readme",e)}}),n(pe,{name:"header",get type(){return ne.Text},get value(){return d.header},valid:!0,onChange:e=>{c("header",e)}})]}}),n(B,{mt:"$2",get disabled(){return!C()||!p()},get loading(){return w()},onClick:async()=>{const r=await x();k(r,()=>{Q.success(e("global.save_success")),a()},(e,t)=>{r.data.id&&l(`/@manage/shares/edit/${r.data.id}`)})},get children(){return e("global."+(o?"save":"add"))}})]}})})}}});

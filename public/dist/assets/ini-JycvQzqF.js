var O,x;function j(){if(x)return O;x=1;const{hasOwnProperty:p}=Object.prototype,m=(e,t={})=>{typeof t=="string"&&(t={section:t}),t.align=t.align===!0,t.newline=t.newline===!0,t.sort=t.sort===!0,t.whitespace=t.whitespace===!0||t.align===!0,t.platform=t.platform||typeof process<"u"&&process.platform,t.bracketedArray=t.bracketedArray!==!1;const s=t.platform==="win32"?"\r\n":"\n",r=t.whitespace?" = ":"=",c=[],o=t.sort?Object.keys(e).sort():Object.keys(e);let y=0;t.align&&(y=h(o.filter(n=>e[n]===null||Array.isArray(e[n])||typeof e[n]!="object").map(n=>Array.isArray(e[n])?"".concat(n,"[]"):n).concat([""]).reduce((n,i)=>h(n).length>=h(i).length?n:i)).length);let f="";const A=t.bracketedArray?"[]":"";for(const n of o){const i=e[n];if(i&&Array.isArray(i))for(const a of i)f+=h("".concat(n).concat(A)).padEnd(y," ")+r+h(a)+s;else i&&typeof i=="object"?c.push(n):f+=h(n).padEnd(y," ")+r+h(i)+s}t.section&&f.length&&(f="["+h(t.section)+"]"+(t.newline?s+s:s)+f);for(const n of c){const i=k(n,".").join("\\."),a=(t.section?t.section+".":"")+i,u=m(e[n],{...t,section:a});f.length&&u.length&&(f+=s),f+=u}return f};function k(e,t){var s=0,r=0,c=0,o=[];do if(c=e.indexOf(t,s),c!==-1){if(s=c+t.length,c>0&&e[c-1]==="\\")continue;o.push(e.slice(r,c)),r=c+t.length}while(c!==-1);return o.push(e.slice(r)),o}const _=(e,t={})=>{t.bracketedArray=t.bracketedArray!==!1;const s=Object.create(null);let r=s,c=null;const o=/^\[([^\]]*)\]\s*$|^([^=]+)(=(.*))?$/i,y=e.split(/[\r\n]+/g),f={};for(const n of y){if(!n||n.match(/^\s*[;#]/)||n.match(/^\s*$/))continue;const i=n.match(o);if(!i)continue;if(i[1]!==void 0){if(c=g(i[1]),c==="__proto__"){r=Object.create(null);continue}r=s[c]=s[c]||Object.create(null);continue}const a=g(i[2]);let u;t.bracketedArray?u=a.length>2&&a.slice(-2)==="[]":(f[a]=((f==null?void 0:f[a])||0)+1,u=f[a]>1);const l=u&&a.endsWith("[]")?a.slice(0,-2):a;if(l==="__proto__")continue;const d=i[3]?g(i[4]):!0,w=d==="true"||d==="false"||d==="null"?JSON.parse(d):d;u&&(p.call(r,l)?Array.isArray(r[l])||(r[l]=[r[l]]):r[l]=[]),Array.isArray(r[l])?r[l].push(w):r[l]=w}const A=[];for(const n of Object.keys(s)){if(!p.call(s,n)||typeof s[n]!="object"||Array.isArray(s[n]))continue;const i=k(n,".");r=s;const a=i.pop(),u=a.replace(/\\\./g,".");for(const l of i)l!=="__proto__"&&((!p.call(r,l)||typeof r[l]!="object")&&(r[l]=Object.create(null)),r=r[l]);r===s&&u===a||(r[u]=s[n],A.push(n))}for(const n of A)delete s[n];return s},b=e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"),h=e=>typeof e!="string"||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&b(e)||e!==e.trim()?JSON.stringify(e):e.split(";").join("\\;").split("#").join("\\#"),g=e=>{if(e=(e||"").trim(),b(e)){e.charAt(0)==="'"&&(e=e.slice(1,-1));try{e=JSON.parse(e)}catch(t){}}else{let t=!1,s="";for(let r=0,c=e.length;r<c;r++){const o=e.charAt(r);if(t)"\\;#".indexOf(o)!==-1?s+=o:s+="\\"+o,t=!1;else{if(";#".indexOf(o)!==-1)break;o==="\\"?t=!0:s+=o}}return t&&(s+="\\"),s.trim()}return e};return O={parse:_,decode:_,stringify:m,encode:m,safe:h,unsafe:g},O}var S=j();export{S as i};
